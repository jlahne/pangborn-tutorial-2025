<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Fine-Tuning Publication-Quality ggplots | Publication-quality data visualizations using the R tidyverse</title>
  <meta name="description" content="3 Fine-Tuning Publication-Quality ggplots | Publication-quality data visualizations using the R tidyverse" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Fine-Tuning Publication-Quality ggplots | Publication-quality data visualizations using the R tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="jlahne/pangborn-tutorial-2025" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Fine-Tuning Publication-Quality ggplots | Publication-quality data visualizations using the R tidyverse" />
  
  
  

<meta name="author" content="Jacob Lahne" />
<meta name="author" content="Kyle Hamilton" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-basics-of-plotting-with-ggplot2.html"/>
<link rel="next" href="using-ggplot-with-other-packages.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction and welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#introductions"><i class="fa fa-check"></i>Introductions</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#kyle-hamilton-phd"><i class="fa fa-check"></i>Kyle Hamilton, PhD</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#jacob-lahne-phd"><i class="fa fa-check"></i>Jacob Lahne, PhD</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#elizabeth-clark-phd"><i class="fa fa-check"></i>Elizabeth Clark, PhD</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#todays-agenda"><i class="fa fa-check"></i>Today’s agenda</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-were-going-to-run"><i class="fa fa-check"></i>How we’re going to run</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#recommended-approach-for-livecoding"><i class="fa fa-check"></i>Recommended approach for livecoding</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dealing-with-errors"><i class="fa fa-check"></i>Dealing with errors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#psa-not-knowing-is-normal"><i class="fa fa-check"></i>PSA: not-knowing is normal!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i>Getting Help</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html"><i class="fa fa-check"></i><b>1</b> Importing and wrangling data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#motivation-exploring-berry-and-cider-cataliking-data"><i class="fa fa-check"></i><b>1.1</b> Motivation: exploring berry and cider CATA/liking data</a></li>
<li class="chapter" data-level="1.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#getting-data-into-r"><i class="fa fa-check"></i><b>1.2</b> Getting data into <code>R</code></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#where-the-data-live"><i class="fa fa-check"></i><b>1.2.1</b> Where the data live</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#the-destination"><i class="fa fa-check"></i><b>1.3</b> The destination</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#cider"><i class="fa fa-check"></i><b>1.3.1</b> Cider</a></li>
<li class="chapter" data-level="1.3.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#berries"><i class="fa fa-check"></i><b>1.3.2</b> Berries</a></li>
<li class="chapter" data-level="1.3.3" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#publication-quality"><i class="fa fa-check"></i><b>1.3.3</b> “Publication quality”</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#saving-your-data"><i class="fa fa-check"></i><b>1.4</b> Saving your data</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#a-note-on-replicability"><i class="fa fa-check"></i><b>1.4.1</b> A note on replicability</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#wrap-up"><i class="fa fa-check"></i><b>1.5</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>2</b> The basics of plotting with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#your-first-ggplot"><i class="fa fa-check"></i><b>2.1</b> Your first <code>ggplot()</code></a></li>
<li class="chapter" data-level="2.2" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#the-aes-function-and-mapping-argument"><i class="fa fa-check"></i><b>2.2</b> The <code>aes()</code> function and <code>mapping =</code> argument</a></li>
<li class="chapter" data-level="2.3" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#adding-layers-with-geom_-functions"><i class="fa fa-check"></i><b>2.3</b> Adding layers with <code>geom_*()</code> functions</a></li>
<li class="chapter" data-level="2.4" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#arguments-inside-and-outside-of-aes"><i class="fa fa-check"></i><b>2.4</b> Arguments inside and outside of <code>aes()</code></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#using-theme_-to-change-visual-options-quickly"><i class="fa fa-check"></i><b>2.4.1</b> Using <code>theme_*()</code> to change visual options quickly</a></li>
<li class="chapter" data-level="2.4.2" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#changing-aesthetic-elements-with-scale_-functions"><i class="fa fa-check"></i><b>2.4.2</b> Changing aesthetic elements with <code>scale_*()</code> functions</a></li>
<li class="chapter" data-level="2.4.3" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#finally-facet_"><i class="fa fa-check"></i><b>2.4.3</b> Finally, <code>facet_*()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#some-further-reading"><i class="fa fa-check"></i><b>2.5</b> Some further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html"><i class="fa fa-check"></i><b>3</b> Fine-Tuning Publication-Quality ggplots</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#exporting-and-saving-plots"><i class="fa fa-check"></i><b>3.1</b> Exporting and Saving Plots</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#what-format"><i class="fa fa-check"></i><b>3.1.1</b> What format?</a></li>
<li class="chapter" data-level="3.1.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#ggsave"><i class="fa fa-check"></i><b>3.1.2</b> Exporting Images with <code>ggsave()</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#other-image-export-options"><i class="fa fa-check"></i><b>3.1.3</b> Other Image Export Options</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#making-text-look-okay"><i class="fa fa-check"></i><b>3.2</b> Making Text Look Okay</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#powerful-text-manipulation-with-stringr"><i class="fa fa-check"></i><b>3.2.1</b> Powerful Text Manipulation with <code>stringr</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#removing-legends-and-plot-elements"><i class="fa fa-check"></i><b>3.3</b> Removing Legends and Plot Elements</a></li>
<li class="chapter" data-level="3.4" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#ordered-categorical-variables"><i class="fa fa-check"></i><b>3.4</b> Ordered Categorical Variables</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#specifying-ordinal-variables-as-factors"><i class="fa fa-check"></i><b>3.4.1</b> Specifying Ordinal Variables as Factors</a></li>
<li class="chapter" data-level="3.4.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#facets-with-different-category-orders"><i class="fa fa-check"></i><b>3.4.2</b> Facets with Different Category-Orders</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#putting-it-all-together"><i class="fa fa-check"></i><b>3.5</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html"><i class="fa fa-check"></i><b>4</b> Using ggplot with Other Packages</a>
<ul>
<li class="chapter" data-level="4.1" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#data-for-the-rest-of-the-tutorial"><i class="fa fa-check"></i><b>4.1</b> Data for the rest of the tutorial</a></li>
<li class="chapter" data-level="4.2" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#new-geom_s-and-stat_s"><i class="fa fa-check"></i><b>4.2</b> New <code>geom_*()s</code> and <code>stat_*()</code>s</a></li>
<li class="chapter" data-level="4.3" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#new-theme_s-and-scale_s"><i class="fa fa-check"></i><b>4.3</b> New <code>theme_*()</code>s and <code>scale_*()</code>s</a></li>
<li class="chapter" data-level="4.4" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#modifying-ggplots-made-by-other-packages"><i class="fa fa-check"></i><b>4.4</b> Modifying <code>ggplot()</code>s made by other packages</a></li>
<li class="chapter" data-level="4.5" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#combining-plots"><i class="fa fa-check"></i><b>4.5</b> Combining Plots</a></li>
<li class="chapter" data-level="4.6" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#finding-new-packages"><i class="fa fa-check"></i><b>4.6</b> Finding New Packages</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html"><i class="fa fa-check"></i><b>5</b> Wrap-up and further resources</a>
<ul>
<li class="chapter" data-level="5.1" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#getting-help-1"><i class="fa fa-check"></i><b>5.1</b> Getting help</a></li>
<li class="chapter" data-level="5.2" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#further-readingresources"><i class="fa fa-check"></i><b>5.2</b> Further reading/resources</a></li>
<li class="chapter" data-level="5.3" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#questionscomments"><i class="fa fa-check"></i><b>5.3</b> Questions/Comments</a></li>
<li class="chapter" data-level="5.4" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#references"><i class="fa fa-check"></i><b>5.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#ggresolution"><i class="fa fa-check"></i>Image Sizes and Raster Resolutions</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#simpler-sizing-vector-images"><i class="fa fa-check"></i>Simpler Sizing: Vector Images</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#raster-image-resolutions"><i class="fa fa-check"></i>Raster Image Resolutions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#regex"><i class="fa fa-check"></i>Regular Expressions</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Publication-quality data visualizations using the R tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fine-tuning-publication-quality-ggplots" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Fine-Tuning Publication-Quality ggplots<a href="fine-tuning-publication-quality-ggplots.html#fine-tuning-publication-quality-ggplots" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The plots we’ve been making so far are fairly straightforward demonstrations. At the very end of Chapter 3, we briefly showed you the code and results for this plot:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="fine-tuning-publication-quality-ggplots.html#cb38-1" tabindex="-1"></a>p1_berry_penalty</span></code></pre></div>
<p><img src="03-finetuning-ggplot_files/figure-html/penalty%20analysis%20example-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Which uses some tricks from the <code>stringr</code> and <code>tidytext</code> packages in order to give us easy-to-read labels. Using the existing column names and variable-codes in our original data to make a first draft of a plot, it would’ve looked more like this:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="fine-tuning-publication-quality-ggplots.html#cb39-1" tabindex="-1"></a>berry_penalty_analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="fine-tuning-publication-quality-ggplots.html#cb39-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>count) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="fine-tuning-publication-quality-ggplots.html#cb39-3" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> checked,</span>
<span id="cb39-4"><a href="fine-tuning-publication-quality-ggplots.html#cb39-4" tabindex="-1"></a>              <span class="at">values_from =</span> penalty_lift,</span>
<span id="cb39-5"><a href="fine-tuning-publication-quality-ggplots.html#cb39-5" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">&quot;checked_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="fine-tuning-publication-quality-ggplots.html#cb39-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">penalty_lift =</span> checked_1 <span class="sc">-</span> checked_0) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="fine-tuning-publication-quality-ggplots.html#cb39-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cata_variable, <span class="at">y =</span> penalty_lift)) <span class="sc">+</span></span>
<span id="cb39-8"><a href="fine-tuning-publication-quality-ggplots.html#cb39-8" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> penalty_lift), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb39-9"><a href="fine-tuning-publication-quality-ggplots.html#cb39-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>berry, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb39-10"><a href="fine-tuning-publication-quality-ggplots.html#cb39-10" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb39-11"><a href="fine-tuning-publication-quality-ggplots.html#cb39-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb39-12"><a href="fine-tuning-publication-quality-ggplots.html#cb39-12" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;tan&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkgreen&quot;</span>)</span></code></pre></div>
<p><img src="03-finetuning-ggplot_files/figure-html/worse%20penalty%20analysis%20example-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Which we’re showing because we have seen similar plots published in journal articles, with the overlapping text, redundant axis labels, and all. We can make this more readable by reordering the CATA attributes, shortening and reformatting the labels, and possibly by removing some extraneous elements like the <code>cata_variable</code> label on the Y axis. These are common steps that make a huge difference.</p>
<p>And we’ll get there, but first…</p>
<div id="exporting-and-saving-plots" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Exporting and Saving Plots<a href="fine-tuning-publication-quality-ggplots.html#exporting-and-saving-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It may seem like a weird time to be talking about saving plots, when we haven’t gotten to the “fine-tuning” yet, but you should already be familiar with a few examples of things that change when the aspect ratio of the plot or the monitor you’re viewing it on changes slightly. It is basically impossible to export a <code>ggplot</code> at the resolution needed for publishing without changing the aspect ratio, relative sizes, or space between some elements from what you’re looking at in the Plots pane or the <code>.Rmd</code> chunk output.</p>
<p>It’s good practice to export your plot as an image (or pdf or knit-together document or however else you plan to export it) and re-export it periodically as you go through fine-tuning.</p>
<p>This is also, probably, the most important part of this chapter. You will have to get every plot that you publish out of <code>R</code> somehow, after all! After that, we’ll cover some tricks that we draw upon frequently, but you may find that you have different problems or priorities, or that some of these needs are situational.</p>
<p>But you will have to export plots for every project you want to share with the world.</p>
<div id="what-format" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> What format?<a href="fine-tuning-publication-quality-ggplots.html#what-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can, as we’ve already discussed, save a <code>ggplot</code> object in a <code>.rds</code> file. But that won’t let you put it into your powerpoint, or manuscript, or take it to the printer. You need an image file. The exact <em>type</em> of image will depend on the other software you’re using for your report, presentation, paper, book, etc.</p>
<p>There are two major ways to save the kind of spatial color data that comprise images such as graphs. You can store them as <strong>vector graphics</strong>, which can be rescaled because they’re made up of lines and shapes (most commonly, <code>.pdf</code> and <code>.svg</code>) or as <strong>raster (bitmap) graphics</strong>, which store images as a grid of <strong>pixels</strong> which each have a single uniform color (most commonly, <code>.png</code> and <code>.jpeg</code>).</p>
<ul>
<li><code>.pdf</code> vector images are best for <strong>LaTeX</strong> and professional publishing</li>
<li><code>.svg</code> vector images are more widely supported in word processors and websites</li>
<li><code>.png</code> raster images are the most predictable to print, the best for web publishing, and can be used in pretty much every software ever made, <em>if</em> you know exactly the size you want.</li>
<li><code>.jpeg</code> (along with <code>.tiff</code>) raster images are the raster format preferred by <em>Food Quality and Preference</em> editors. They are worse for web publishing than <code>.png</code> but share its other advantages.</li>
</ul>
<p>Note that <code>ggsave()</code> is like making a <code>.pdf</code> version of your working documents: you will not be able to read the plot images into <code>R</code> for editing anymore, no matter which format you save in.</p>
</div>
<div id="ggsave" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Exporting Images with <code>ggsave()</code><a href="fine-tuning-publication-quality-ggplots.html#ggsave" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The easiest way to reproducibly save plots, so that all of your export options are in your code and you might be able to recreate it on a different computer, is with the function <code>ggplot2::ggsave()</code>, which works <em>similarly</em> to the <code>write_*()</code> functions and <code>save()</code>. You give it a file name to save to, relative to the current working directory, and then the variable where your plot is saved.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="fine-tuning-publication-quality-ggplots.html#cb40-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/penalty-lift-png.png&quot;</span>, p1_berry_penalty)</span></code></pre></div>
<p><code>ggsave()</code> supports all of the above-named image formats, as well as <code>.eps</code>, <code>.ps</code>, <code>.tex</code> (pictex), and <code>.bmp</code>. It will figure out from the file extension (the stuff after the <code>.</code> in the <code>filename</code> argument) what image type it’s saving as, but you can also specify it explicitly with the <code>device</code> argument.</p>
<p>If you’re reading this right now, you’re looking at a webpage created using <code>bookdown</code> and <code>knitr</code>. We can’t actually directly embed <code>.pdf</code> images in this site, but let’s look at a few other example formats using the same plots.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="fine-tuning-publication-quality-ggplots.html#cb41-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/penalty-lift-svg.svg&quot;</span>, p1_berry_penalty)</span>
<span id="cb41-2"><a href="fine-tuning-publication-quality-ggplots.html#cb41-2" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/penalty-lift-jpeg.jpeg&quot;</span>, p1_berry_penalty)</span></code></pre></div>
<p>Now let’s compare how each of these looks! First, inside R:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="fine-tuning-publication-quality-ggplots.html#cb42-1" tabindex="-1"></a>p1_berry_penalty <span class="co"># If you&#39;re following along, this will look different in your R session!</span></span></code></pre></div>
<p><img src="03-finetuning-ggplot_files/figure-html/viewing%20the%20plot%20inside%20R-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The <code>.svg</code> image made by <code>ggsave()</code>:</p>
<p><img src="img/penalty-lift-svg.svg" width="672px" style="display: block; margin: auto;" /></p>
<p>The <code>.png</code> image made by <code>ggsave()</code>:</p>
<p><img src="img/penalty-lift-png.png" width="672px" style="display: block; margin: auto;" /></p>
<p>The <code>.jpeg</code> image made by <code>ggsave()</code>:</p>
<p><img src="img/penalty-lift-jpeg.jpeg" width="672px" style="display: block; margin: auto;" /></p>
<p>The two raster formats look basically the same, and only slightly different from the <code>.svg</code> and the version in the <code>.html</code> version of this tutorial. If you’re following along in your own <code>R</code> session, however, you’ll notice that these saved plots all look more similar to each other than they do to the initial plot you’re previewing inside <code>R</code>. <em>All</em> of the plots have a bit more space around the text using <code>ggsave()</code>, taller bars, and a different aspect ratio (<span class="math inline">\(width/height\)</span>).</p>
<p>We can adjust these using the rest of the arguments to <code>ggsave()</code>. The <code>width</code>, <code>height</code>, and <code>units</code> primarily control the image size (for raster images) and aspect ratio (for all images), but they also affect the relative size of plot elements. Larger plots will have axis labels, text, and <code>geom_*()</code>s that take up less of the overall plotting area, and vice-versa for smaller images.</p>
<p>If you get to this stage with a <strong>vector image</strong> and realize that all of the fixed-size elements (e.g., text) are too big or too small, you can use <code>ggsave()</code>’s <code>scale</code> argument. <code>scale</code> &lt; 1 makes all the fixed-size elements <em>smaller</em> relative to the plot size and <code>scale</code> &gt; 1 makes all the elements <em>bigger</em> relative to the plot size. <code>scale</code> &lt; 1 will generally also give you a <em>larger plot area</em> and <em>more space between your geoms</em>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="fine-tuning-publication-quality-ggplots.html#cb43-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/penalty-lift-svg-7x4.svg&quot;</span>, p1_berry_penalty,</span>
<span id="cb43-2"><a href="fine-tuning-publication-quality-ggplots.html#cb43-2" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>)</span>
<span id="cb43-3"><a href="fine-tuning-publication-quality-ggplots.html#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="fine-tuning-publication-quality-ggplots.html#cb43-4" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/penalty-lift-svg-14x8.svg&quot;</span>, p1_berry_penalty,</span>
<span id="cb43-5"><a href="fine-tuning-publication-quality-ggplots.html#cb43-5" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>)</span>
<span id="cb43-6"><a href="fine-tuning-publication-quality-ggplots.html#cb43-6" tabindex="-1"></a></span>
<span id="cb43-7"><a href="fine-tuning-publication-quality-ggplots.html#cb43-7" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/penalty-lift-svg-14x8-rescale.svg&quot;</span>, p1_berry_penalty,</span>
<span id="cb43-8"><a href="fine-tuning-publication-quality-ggplots.html#cb43-8" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>, <span class="at">scale =</span> .<span class="dv">5</span>)</span></code></pre></div>
<p>The 7x4” vector plot:</p>
<p><img src="img/penalty-lift-svg-7x4.svg" width="672px" style="display: block; margin: auto;" /></p>
<p>The same plot saved at 14x8”:</p>
<p><img src="img/penalty-lift-svg-14x8.svg" width="672px" style="display: block; margin: auto;" /></p>
<p>A 14.8” plot with <code>scale = 0.5</code>:</p>
<p><img src="img/penalty-lift-svg-14x8-rescale.svg" width="672px" style="display: block; margin: auto;" /></p>
<p>All of these <code>.svg</code> images are <em>displayed</em> at 7x4” on your screen, but the plot we made with <code>width = 14, height = 8</code> has smaller text and larger plotting areas unless we correct this with <code>scale</code>. <code>penalty-lift-svg-7x4.svg</code> and <code>penalty-lift-svg-14x8-rescale.svg</code> are actually identical files.</p>
<p>You should <em>avoid using <code>scale</code> for rasters</em>, as it will create plots that will not print at the size (<code>width</code> and <code>height</code>) and resolution (<code>dpi</code>) you specified. If you find yourself wanting to change the <code>scale</code> of a raster image, you should refer to the reference we’ve put together on <code>dpi</code> in the <a href="appendix.html#ggresolution">Appendix</a>.</p>
</div>
<div id="other-image-export-options" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Other Image Export Options<a href="fine-tuning-publication-quality-ggplots.html#other-image-export-options" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is not a <code>knitr</code> or <code>bookdown</code> tutorial, because we had to choose our topics, but we used the <code>bookdown</code> package to make the <a href="https://lhami.github.io/sensometrics-r-tutorial-2024/">online webpage version of this tutorial</a>. It comes with its own advantages and challenges, but it does significantly streamline the image-generation process for any project where the only file you need is one LaTeX file, <code>.html</code> page, or <code>.pdf</code> output with all of the text and all of the figures. If that sounds appealing to you, turn your attention to <a href="https://bookdown.org/yihui/bookdown/">“bookdown: Authoring Books and Technical Documents with <code>R</code> Markdown” by Yihui Xie</a>.</p>
</div>
</div>
<div id="making-text-look-okay" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Making Text Look Okay<a href="fine-tuning-publication-quality-ggplots.html#making-text-look-okay" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A good <code>R</code> variable or column name doesn’t have any spaces or punctuation other than underscores (<code>_</code>) and dots (<code>.</code>), to avoid all those pesky backticks (```) in our code.</p>
<p>This is very different from what a good label in a plot looks like. You’ll often want to make some sort of mass changes to column names or text variables before plotting, in order to address this.</p>
<div id="powerful-text-manipulation-with-stringr" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Powerful Text Manipulation with <code>stringr</code><a href="fine-tuning-publication-quality-ggplots.html#powerful-text-manipulation-with-stringr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>stringr</code> package is a part of the <code>tidyverse</code>, so you have it already loaded whenever you run <code>library(tidyverse)</code>. It has a lot of useful functions for working with text (called “<strong>str</strong>ings” in many programming languages), mostly of the form <code>str_*()</code>. One thing you can do is change labels to uppercase, lowercase, “sentence case”, or “title case” (first letter of each word capitalized), as appropriate:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="fine-tuning-publication-quality-ggplots.html#cb44-1" tabindex="-1"></a>berry_penalty_analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="fine-tuning-publication-quality-ggplots.html#cb44-2" tabindex="-1"></a>  <span class="fu">select</span>(berry) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="fine-tuning-publication-quality-ggplots.html#cb44-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Upper =</span> <span class="fu">str_to_upper</span>(berry),</span>
<span id="cb44-4"><a href="fine-tuning-publication-quality-ggplots.html#cb44-4" tabindex="-1"></a>         <span class="at">Title =</span> <span class="fu">str_to_title</span>(berry)) <span class="co"># Capitalizes the first letter of each word</span></span></code></pre></div>
<pre><code>## # A tibble: 170 × 3
##    berry      Upper      Title     
##    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     
##  1 blackberry BLACKBERRY Blackberry
##  2 blackberry BLACKBERRY Blackberry
##  3 blackberry BLACKBERRY Blackberry
##  4 blackberry BLACKBERRY Blackberry
##  5 blackberry BLACKBERRY Blackberry
##  6 blackberry BLACKBERRY Blackberry
##  7 blackberry BLACKBERRY Blackberry
##  8 blackberry BLACKBERRY Blackberry
##  9 blackberry BLACKBERRY Blackberry
## 10 blackberry BLACKBERRY Blackberry
## # ℹ 160 more rows</code></pre>
<p><code>str_replace()</code> and <code>str_replace_all()</code> are very useful for dealing with underscores or periods. You give it <code>string</code>, the text vector you want to modify (inside <code>mutate()</code>, a column name); then <code>pattern</code>, the character(s) you want to replace; then <code>replacement</code>, what you want to replace them with.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="fine-tuning-publication-quality-ggplots.html#cb46-1" tabindex="-1"></a>berry_penalty_analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="fine-tuning-publication-quality-ggplots.html#cb46-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>count) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="fine-tuning-publication-quality-ggplots.html#cb46-3" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> checked,</span>
<span id="cb46-4"><a href="fine-tuning-publication-quality-ggplots.html#cb46-4" tabindex="-1"></a>              <span class="at">values_from =</span> penalty_lift,</span>
<span id="cb46-5"><a href="fine-tuning-publication-quality-ggplots.html#cb46-5" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">&quot;checked_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="fine-tuning-publication-quality-ggplots.html#cb46-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cata_variable =</span> <span class="fu">str_replace_all</span>(cata_variable, <span class="st">&quot;_&quot;</span>, <span class="st">&quot;: &quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 85 × 4
##    berry      cata_variable           checked_0 checked_1
##    &lt;chr&gt;      &lt;chr&gt;                       &lt;dbl&gt;     &lt;dbl&gt;
##  1 blackberry appearance: fresh            4.70      5.80
##  2 blackberry appearance: goodcolor        4.63      5.77
##  3 blackberry appearance: goodquality      4.69      5.96
##  4 blackberry appearance: goodshapre       4.93      5.86
##  5 blackberry appearance: misshapen        5.63      4.92
##  6 blackberry appearance: none             5.42      4.78
##  7 blackberry appearance: notfresh         5.57      3.76
##  8 blackberry appearance: unevencolor      5.53      4.53
##  9 blackberry appearane: bruised           5.53      4.67
## 10 blackberry taste: berry                 4.21      6.49
## # ℹ 75 more rows</code></pre>
<p>They can both be as long as you like. If <code>pattern = _</code> and there’s more than one <code>_</code> in one of the <code>string</code>s, <code>str_replace()</code> will only replace the first one and <code>str_replace_all()</code> will replace them all.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="fine-tuning-publication-quality-ggplots.html#cb48-1" tabindex="-1"></a><span class="fu">str_replace</span>(<span class="st">&quot;long_text_with_many_underscores&quot;</span>, <span class="st">&quot;_&quot;</span>, <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;long text_with_many_underscores&quot;</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="fine-tuning-publication-quality-ggplots.html#cb50-1" tabindex="-1"></a><span class="fu">str_replace_all</span>(<span class="st">&quot;long_text_with_many_underscores&quot;</span>, <span class="st">&quot;_&quot;</span>, <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;long text with many underscores&quot;</code></pre>
<p>You can add multiple sets of <code>pattern</code>s and <code>replace</code>ments to <code>str_replace_all()</code> using a named list: <code>c("pattern1" = "replace1", "pattern2" = "replace2"</code>. This is useful to, for instance, fix multiple typos like “goodshapre”. Unlike the <code>case_when()</code> example we showed before, you can fix typos that occur anywhere in the text, even if they’re only parts of a word.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="fine-tuning-publication-quality-ggplots.html#cb52-1" tabindex="-1"></a>berry_penalty_analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="fine-tuning-publication-quality-ggplots.html#cb52-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>count) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="fine-tuning-publication-quality-ggplots.html#cb52-3" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> checked,</span>
<span id="cb52-4"><a href="fine-tuning-publication-quality-ggplots.html#cb52-4" tabindex="-1"></a>              <span class="at">values_from =</span> penalty_lift,</span>
<span id="cb52-5"><a href="fine-tuning-publication-quality-ggplots.html#cb52-5" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">&quot;checked_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="fine-tuning-publication-quality-ggplots.html#cb52-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cata_variable =</span> <span class="fu">str_replace_all</span>(cata_variable,</span>
<span id="cb52-7"><a href="fine-tuning-publication-quality-ggplots.html#cb52-7" tabindex="-1"></a>                                         <span class="fu">c</span>(<span class="st">&quot;shapre&quot;</span> <span class="ot">=</span> <span class="st">&quot;shape&quot;</span>,</span>
<span id="cb52-8"><a href="fine-tuning-publication-quality-ggplots.html#cb52-8" tabindex="-1"></a>                                           <span class="st">&quot;appearane&quot;</span> <span class="ot">=</span> <span class="st">&quot;appearance&quot;</span>,</span>
<span id="cb52-9"><a href="fine-tuning-publication-quality-ggplots.html#cb52-9" tabindex="-1"></a>                                           <span class="st">&quot;_&quot;</span> <span class="ot">=</span> <span class="st">&quot; &quot;</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 85 × 4
##    berry      cata_variable          checked_0 checked_1
##    &lt;chr&gt;      &lt;chr&gt;                      &lt;dbl&gt;     &lt;dbl&gt;
##  1 blackberry appearance fresh            4.70      5.80
##  2 blackberry appearance goodcolor        4.63      5.77
##  3 blackberry appearance goodquality      4.69      5.96
##  4 blackberry appearance goodshape        4.93      5.86
##  5 blackberry appearance misshapen        5.63      4.92
##  6 blackberry appearance none             5.42      4.78
##  7 blackberry appearance notfresh         5.57      3.76
##  8 blackberry appearance unevencolor      5.53      4.53
##  9 blackberry appearance bruised          5.53      4.67
## 10 blackberry taste berry                 4.21      6.49
## # ℹ 75 more rows</code></pre>
<p>Be careful using short <code>pattern</code>s, because they will replace every example <em>even if it’s only part of a word</em>.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="fine-tuning-publication-quality-ggplots.html#cb54-1" tabindex="-1"></a><span class="co">#This can lead to unintentional side-effects</span></span>
<span id="cb54-2"><a href="fine-tuning-publication-quality-ggplots.html#cb54-2" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;nocolor&quot;</span>, <span class="st">&quot;none&quot;</span>, <span class="st">&quot;cornonthecob&quot;</span>, <span class="st">&quot;anode&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="fine-tuning-publication-quality-ggplots.html#cb54-3" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot; NO &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot; NO color&quot;      &quot; NO ne&quot;         &quot;cor NO nthecob&quot; &quot;a NO de&quot;</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="fine-tuning-publication-quality-ggplots.html#cb56-1" tabindex="-1"></a><span class="co">#Or it can be useful for fixing lots of similar problems all at once</span></span>
<span id="cb56-2"><a href="fine-tuning-publication-quality-ggplots.html#cb56-2" tabindex="-1"></a>berry_penalty_analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="fine-tuning-publication-quality-ggplots.html#cb56-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>count) <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="fine-tuning-publication-quality-ggplots.html#cb56-4" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> checked,</span>
<span id="cb56-5"><a href="fine-tuning-publication-quality-ggplots.html#cb56-5" tabindex="-1"></a>              <span class="at">values_from =</span> penalty_lift,</span>
<span id="cb56-6"><a href="fine-tuning-publication-quality-ggplots.html#cb56-6" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">&quot;checked_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-7"><a href="fine-tuning-publication-quality-ggplots.html#cb56-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cata_variable =</span> <span class="fu">str_replace_all</span>(cata_variable,</span>
<span id="cb56-8"><a href="fine-tuning-publication-quality-ggplots.html#cb56-8" tabindex="-1"></a>                                         <span class="fu">c</span>(<span class="st">&quot;not&quot;</span> <span class="ot">=</span> <span class="st">&quot;not &quot;</span>,</span>
<span id="cb56-9"><a href="fine-tuning-publication-quality-ggplots.html#cb56-9" tabindex="-1"></a>                                           <span class="st">&quot;good&quot;</span> <span class="ot">=</span> <span class="st">&quot;good &quot;</span>,</span>
<span id="cb56-10"><a href="fine-tuning-publication-quality-ggplots.html#cb56-10" tabindex="-1"></a>                                           <span class="st">&quot;uneven&quot;</span> <span class="ot">=</span> <span class="st">&quot;uneven &quot;</span>,</span>
<span id="cb56-11"><a href="fine-tuning-publication-quality-ggplots.html#cb56-11" tabindex="-1"></a>                                           <span class="st">&quot;_&quot;</span> <span class="ot">=</span> <span class="st">&quot; &quot;</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 85 × 4
##    berry      cata_variable           checked_0 checked_1
##    &lt;chr&gt;      &lt;chr&gt;                       &lt;dbl&gt;     &lt;dbl&gt;
##  1 blackberry appearance fresh             4.70      5.80
##  2 blackberry appearance good color        4.63      5.77
##  3 blackberry appearance good quality      4.69      5.96
##  4 blackberry appearance good shapre       4.93      5.86
##  5 blackberry appearance misshapen         5.63      4.92
##  6 blackberry appearance none              5.42      4.78
##  7 blackberry appearance not fresh         5.57      3.76
##  8 blackberry appearance uneven color      5.53      4.53
##  9 blackberry appearane bruised            5.53      4.67
## 10 blackberry taste berry                  4.21      6.49
## # ℹ 75 more rows</code></pre>
<p>So far, we’ve been replacing letters and underscores, which is what we have in our example data. You can also use <code>str_replace()</code> for periods (<code>.</code>), although you may be surprised when you first try:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="fine-tuning-publication-quality-ggplots.html#cb58-1" tabindex="-1"></a><span class="fu">str_replace_all</span>(<span class="st">&quot;long.text.with.many.periods&quot;</span>, <span class="st">&quot;.&quot;</span>, <span class="st">&quot; &quot;</span>) <span class="co"># Replaces everything</span></span></code></pre></div>
<pre><code>## [1] &quot;                           &quot;</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="fine-tuning-publication-quality-ggplots.html#cb60-1" tabindex="-1"></a><span class="fu">str_replace_all</span>(<span class="st">&quot;long.text.with.many.periods&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, <span class="st">&quot; &quot;</span>) <span class="co"># Replaces only dots</span></span></code></pre></div>
<pre><code>## [1] &quot;long text with many periods&quot;</code></pre>
<p>We have to <strong>escape</strong> the period (with an escaped backslash, technically, but for now just know that you must put two backslashes <code>\\</code> before special characters when using <code>stringr</code>). Because the <code>str_*</code> functions with a <code>pattern</code> can use <strong>Regular Expressions</strong> (or regex), the characters (<code>\</code>, <code>.</code>, <code>[</code>, <code>]</code>, <code>{</code>, <code>}</code>, <code>(</code>, <code>)</code>, <code>&lt;</code>, <code>&gt;</code>, <code>*</code>, <code>+</code>, <code>-</code>, <code>=</code>, <code>!</code>, <code>?</code>, <code>^</code>, <code>$</code>, and <code>|</code>) need to be <strong>escaped</strong> with two backslashes if you need to replace them.</p>
<p>Regex are extremely powerful tools for finding patterns in text, similar to the intuitive ways a human might recognize something like an email address, a measurement, or a parenthetical. We will not be talking about regex today, but if you want to see some examples and resources for learning how to use them, we’ve provided a short overview and links to some resources in the <a href="appendix.html#regex">Appendix</a>.</p>
</div>
</div>
<div id="removing-legends-and-plot-elements" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Removing Legends and Plot Elements<a href="fine-tuning-publication-quality-ggplots.html#removing-legends-and-plot-elements" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You’ve already seen us use <code>+ theme(panel.grid = element_blank())</code> to get rid of the grid lines in a plot. You can use <code>element_blank()</code> to get rid of lots of plot elements you might not want for whatever reason, usually because it’s redundant with information you have elsewhere and thus just making the plot look more complicated or harder to read at a glance. The most common things you might want to remove are:</p>
<ul>
<li><code>plot.title</code>, if some function added a title to the top of your plot and you want to get rid of it.</li>
<li><code>axis.title</code>, <code>axis.title.x</code>, or <code>axis.title.y</code> if you don’t need the column name(s) labeling your axes</li>
<li><code>axis.ticks</code>, <code>axis.ticks.x</code>, or <code>axis.ticks.y</code> if you want to remove the little tick marks along a given axis (useful for bar plots)</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="fine-tuning-publication-quality-ggplots.html#cb62-1" tabindex="-1"></a>berry_long_liking <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="fine-tuning-publication-quality-ggplots.html#cb62-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Scale, <span class="at">y =</span> Liking, <span class="at">color =</span> Scale)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="fine-tuning-publication-quality-ggplots.html#cb62-3" tabindex="-1"></a>  ggbeeswarm<span class="sc">::</span><span class="fu">geom_quasirandom</span>() <span class="sc">+</span></span>
<span id="cb62-4"><a href="fine-tuning-publication-quality-ggplots.html#cb62-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Attribute) <span class="sc">+</span></span>
<span id="cb62-5"><a href="fine-tuning-publication-quality-ggplots.html#cb62-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb62-6"><a href="fine-tuning-publication-quality-ggplots.html#cb62-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb62-7"><a href="fine-tuning-publication-quality-ggplots.html#cb62-7" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb62-8"><a href="fine-tuning-publication-quality-ggplots.html#cb62-8" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="03-finetuning-ggplot_files/figure-html/removing%20the%20legend%20and%20the%20axis%20ticks-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can see a nearly-full list of the arguments to <code>ggplot2::theme()</code> in the theme help files (<code>?theme</code>), unlike with <code>ggplot2</code> aesthetics and the <code>geom_*()</code> help files.</p>
<p>If you want to remove the legend, you use <code>+ theme(legend.position = "none")</code>, but if you want to remove <em>specific geoms</em> from the legend, then you have to adjust your <code>geom_*()</code> calls.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="fine-tuning-publication-quality-ggplots.html#cb63-1" tabindex="-1"></a>ca_cider<span class="sc">$</span>col<span class="sc">$</span>coord <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="fine-tuning-publication-quality-ggplots.html#cb63-2" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;Attribute&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="fine-tuning-publication-quality-ggplots.html#cb63-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modality =</span> <span class="fu">case_when</span>(Attribute <span class="sc">==</span> <span class="st">&quot;Sweet&quot;</span> <span class="sc">~</span> <span class="st">&quot;Taste&quot;</span>,</span>
<span id="cb63-4"><a href="fine-tuning-publication-quality-ggplots.html#cb63-4" tabindex="-1"></a>                              Attribute <span class="sc">==</span> <span class="st">&quot;Bitter&quot;</span> <span class="sc">~</span> <span class="st">&quot;Taste&quot;</span>,</span>
<span id="cb63-5"><a href="fine-tuning-publication-quality-ggplots.html#cb63-5" tabindex="-1"></a>                              Attribute <span class="sc">==</span> <span class="st">&quot;Sour&quot;</span> <span class="sc">~</span> <span class="st">&quot;Taste&quot;</span>,</span>
<span id="cb63-6"><a href="fine-tuning-publication-quality-ggplots.html#cb63-6" tabindex="-1"></a>                              Attribute <span class="sc">==</span> <span class="st">&quot;Smooth&quot;</span> <span class="sc">~</span> <span class="st">&quot;Mouthfeel&quot;</span>,</span>
<span id="cb63-7"><a href="fine-tuning-publication-quality-ggplots.html#cb63-7" tabindex="-1"></a>                              Attribute <span class="sc">==</span> <span class="st">&quot;Dry&quot;</span> <span class="sc">~</span> <span class="st">&quot;Mouthfeel&quot;</span>,</span>
<span id="cb63-8"><a href="fine-tuning-publication-quality-ggplots.html#cb63-8" tabindex="-1"></a>                              Attribute <span class="sc">==</span> <span class="st">&quot;FullBodied&quot;</span> <span class="sc">~</span> <span class="st">&quot;Mouthfeel&quot;</span>,</span>
<span id="cb63-9"><a href="fine-tuning-publication-quality-ggplots.html#cb63-9" tabindex="-1"></a>                              <span class="at">.default =</span> <span class="st">&quot;Aroma&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-10"><a href="fine-tuning-publication-quality-ggplots.html#cb63-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>,</span>
<span id="cb63-11"><a href="fine-tuning-publication-quality-ggplots.html#cb63-11" tabindex="-1"></a>             <span class="at">label =</span> Attribute, <span class="at">color =</span> Modality)) <span class="ot">-&gt;</span> ca_cider_colored</span>
<span id="cb63-12"><a href="fine-tuning-publication-quality-ggplots.html#cb63-12" tabindex="-1"></a></span>
<span id="cb63-13"><a href="fine-tuning-publication-quality-ggplots.html#cb63-13" tabindex="-1"></a>ca_cider_colored <span class="sc">+</span></span>
<span id="cb63-14"><a href="fine-tuning-publication-quality-ggplots.html#cb63-14" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb63-15"><a href="fine-tuning-publication-quality-ggplots.html#cb63-15" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>()</span></code></pre></div>
<p><img src="03-finetuning-ggplot_files/figure-html/excluding%20geoms%20from%20the%20legend-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="fine-tuning-publication-quality-ggplots.html#cb64-1" tabindex="-1"></a>ca_cider_colored <span class="sc">+</span></span>
<span id="cb64-2"><a href="fine-tuning-publication-quality-ggplots.html#cb64-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-3"><a href="fine-tuning-publication-quality-ggplots.html#cb64-3" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="03-finetuning-ggplot_files/figure-html/excluding%20geoms%20from%20the%20legend-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="ordered-categorical-variables" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Ordered Categorical Variables<a href="fine-tuning-publication-quality-ggplots.html#ordered-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many of the figures we’ve made so far have had one axis with a categorical variable. Have you figured out how <code>ggplot2</code> orders the levels of categorical variables? If you have noticed, it’s likely because it’s in a different order than the one we’d like.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="fine-tuning-publication-quality-ggplots.html#cb65-1" tabindex="-1"></a>long_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="fine-tuning-publication-quality-ggplots.html#cb65-2" tabindex="-1"></a>  <span class="fu">filter</span>(checked <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="fine-tuning-publication-quality-ggplots.html#cb65-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cata_variable)) <span class="sc">+</span></span>
<span id="cb65-4"><a href="fine-tuning-publication-quality-ggplots.html#cb65-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb65-5"><a href="fine-tuning-publication-quality-ggplots.html#cb65-5" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb65-6"><a href="fine-tuning-publication-quality-ggplots.html#cb65-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">vars</span>(Temperature), <span class="fu">vars</span>(Sample_Name))</span></code></pre></div>
<p><img src="03-finetuning-ggplot_files/figure-html/default%20categorical%20axis%20in%20ggplot2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The CATA attributes are in alphabetical order. This is how <code>ggplot2</code> treats all <code>character</code> variables, and you can exert some control over the ordering by turning the variable into an ordered <code>factor</code>.</p>
<div id="specifying-ordinal-variables-as-factors" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Specifying Ordinal Variables as Factors<a href="fine-tuning-publication-quality-ggplots.html#specifying-ordinal-variables-as-factors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can order variables by hand, if there’s a particular order you have in mind:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="fine-tuning-publication-quality-ggplots.html#cb66-1" tabindex="-1"></a>long_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="fine-tuning-publication-quality-ggplots.html#cb66-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cata_variable =</span> <span class="fu">factor</span>(cata_variable,</span>
<span id="cb66-3"><a href="fine-tuning-publication-quality-ggplots.html#cb66-3" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Sweet&quot;</span>, <span class="st">&quot;Sour&quot;</span>, <span class="st">&quot;Bitter&quot;</span>,</span>
<span id="cb66-4"><a href="fine-tuning-publication-quality-ggplots.html#cb66-4" tabindex="-1"></a>                                           <span class="st">&quot;Smooth&quot;</span>, <span class="st">&quot;Dry&quot;</span>, <span class="st">&quot;FullBodied&quot;</span>,</span>
<span id="cb66-5"><a href="fine-tuning-publication-quality-ggplots.html#cb66-5" tabindex="-1"></a>                                           <span class="st">&quot;Light&quot;</span>,</span>
<span id="cb66-6"><a href="fine-tuning-publication-quality-ggplots.html#cb66-6" tabindex="-1"></a>                                           <span class="st">&quot;Fruity&quot;</span>, <span class="st">&quot;Berries&quot;</span>, <span class="st">&quot;Fresh_Apples&quot;</span>,</span>
<span id="cb66-7"><a href="fine-tuning-publication-quality-ggplots.html#cb66-7" tabindex="-1"></a>                                           <span class="st">&quot;Floral&quot;</span>, <span class="st">&quot;Spice&quot;</span>,</span>
<span id="cb66-8"><a href="fine-tuning-publication-quality-ggplots.html#cb66-8" tabindex="-1"></a>                                           <span class="st">&quot;Herbal&quot;</span>, <span class="st">&quot;Woody&quot;</span>, <span class="st">&quot;Earthy&quot;</span>,</span>
<span id="cb66-9"><a href="fine-tuning-publication-quality-ggplots.html#cb66-9" tabindex="-1"></a>                                           <span class="st">&quot;Funky&quot;</span>, <span class="st">&quot;Fermented&quot;</span>, <span class="st">&quot;Vomit&quot;</span>,</span>
<span id="cb66-10"><a href="fine-tuning-publication-quality-ggplots.html#cb66-10" tabindex="-1"></a>                                           <span class="st">&quot;Synthetic&quot;</span>, <span class="st">&quot;Candy&quot;</span>,</span>
<span id="cb66-11"><a href="fine-tuning-publication-quality-ggplots.html#cb66-11" tabindex="-1"></a>                                           <span class="st">&quot;Metallic&quot;</span>, <span class="st">&quot;Alcohol&quot;</span>))) <span class="ot">-&gt;</span> long_cider_manual_factors</span>
<span id="cb66-12"><a href="fine-tuning-publication-quality-ggplots.html#cb66-12" tabindex="-1"></a></span>
<span id="cb66-13"><a href="fine-tuning-publication-quality-ggplots.html#cb66-13" tabindex="-1"></a>long_cider_manual_factors <span class="sc">%&gt;%</span></span>
<span id="cb66-14"><a href="fine-tuning-publication-quality-ggplots.html#cb66-14" tabindex="-1"></a>  <span class="fu">filter</span>(checked <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-15"><a href="fine-tuning-publication-quality-ggplots.html#cb66-15" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cata_variable)) <span class="sc">+</span></span>
<span id="cb66-16"><a href="fine-tuning-publication-quality-ggplots.html#cb66-16" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb66-17"><a href="fine-tuning-publication-quality-ggplots.html#cb66-17" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb66-18"><a href="fine-tuning-publication-quality-ggplots.html#cb66-18" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">vars</span>(Temperature), <span class="fu">vars</span>(Sample_Name))</span></code></pre></div>
<p><img src="03-finetuning-ggplot_files/figure-html/manually%20making%20ordered%20factors-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note that the attribute you list <em>first</em> when you’re specifying the <code>levels</code> will become 1, then 2, then 3. With <code>coord_flip()</code>, that puts it at the bottom of the plot.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="fine-tuning-publication-quality-ggplots.html#cb67-1" tabindex="-1"></a>long_cider_manual_factors <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="fine-tuning-publication-quality-ggplots.html#cb67-2" tabindex="-1"></a>  <span class="fu">distinct</span>(cata_variable) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="fine-tuning-publication-quality-ggplots.html#cb67-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable_number =</span> <span class="fu">as.numeric</span>(cata_variable))</span></code></pre></div>
<pre><code>## # A tibble: 22 × 2
##    cata_variable variable_number
##    &lt;fct&gt;                   &lt;dbl&gt;
##  1 Fresh_Apples               10
##  2 Fermented                  17
##  3 Herbal                     13
##  4 Dry                         5
##  5 Spice                      12
##  6 Fruity                      8
##  7 Smooth                      4
##  8 Alcohol                    22
##  9 Light                       7
## 10 Sweet                       1
## # ℹ 12 more rows</code></pre>
<p>This gives us control, but it’s pretty annoying to write out for large lists of attributes, and you have to be sure the spelling and capitalization match exactly. Often, like with the penalty analysis plots, what we actually want to do is order the Attributes in terms of some other numerical variable, like frequency or size of penalty.</p>
<p>One way is to <code>arrange()</code> the data the way you want it and then use that order to specify the levels.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="fine-tuning-publication-quality-ggplots.html#cb69-1" tabindex="-1"></a>long_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="fine-tuning-publication-quality-ggplots.html#cb69-2" tabindex="-1"></a>  <span class="co"># Counting the number of times each attribute is used across all products:</span></span>
<span id="cb69-3"><a href="fine-tuning-publication-quality-ggplots.html#cb69-3" tabindex="-1"></a>  <span class="fu">group_by</span>(cata_variable) <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="fine-tuning-publication-quality-ggplots.html#cb69-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable_count =</span> <span class="fu">sum</span>(checked)) <span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="fine-tuning-publication-quality-ggplots.html#cb69-5" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="fine-tuning-publication-quality-ggplots.html#cb69-6" tabindex="-1"></a>  <span class="co"># Arranging from least-to-most used:</span></span>
<span id="cb69-7"><a href="fine-tuning-publication-quality-ggplots.html#cb69-7" tabindex="-1"></a>  <span class="fu">arrange</span>(variable_count) <span class="sc">%&gt;%</span></span>
<span id="cb69-8"><a href="fine-tuning-publication-quality-ggplots.html#cb69-8" tabindex="-1"></a>  <span class="co"># Converting to a factor, so the least-used will be 1st, then the next:</span></span>
<span id="cb69-9"><a href="fine-tuning-publication-quality-ggplots.html#cb69-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cata_variable =</span> <span class="fu">factor</span>(cata_variable, <span class="at">levels =</span> <span class="fu">unique</span>(cata_variable),</span>
<span id="cb69-10"><a href="fine-tuning-publication-quality-ggplots.html#cb69-10" tabindex="-1"></a>                            <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb69-11"><a href="fine-tuning-publication-quality-ggplots.html#cb69-11" tabindex="-1"></a>         <span class="at">variable_number =</span> <span class="fu">as.numeric</span>(cata_variable)) <span class="ot">-&gt;</span> long_cider_frequency_factors</span>
<span id="cb69-12"><a href="fine-tuning-publication-quality-ggplots.html#cb69-12" tabindex="-1"></a></span>
<span id="cb69-13"><a href="fine-tuning-publication-quality-ggplots.html#cb69-13" tabindex="-1"></a><span class="co">#Now the plot:</span></span>
<span id="cb69-14"><a href="fine-tuning-publication-quality-ggplots.html#cb69-14" tabindex="-1"></a>long_cider_frequency_factors <span class="sc">%&gt;%</span></span>
<span id="cb69-15"><a href="fine-tuning-publication-quality-ggplots.html#cb69-15" tabindex="-1"></a>  <span class="fu">filter</span>(checked <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-16"><a href="fine-tuning-publication-quality-ggplots.html#cb69-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cata_variable)) <span class="sc">+</span></span>
<span id="cb69-17"><a href="fine-tuning-publication-quality-ggplots.html#cb69-17" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb69-18"><a href="fine-tuning-publication-quality-ggplots.html#cb69-18" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb69-19"><a href="fine-tuning-publication-quality-ggplots.html#cb69-19" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">vars</span>(Temperature), <span class="fu">vars</span>(Sample_Name))</span></code></pre></div>
<p><img src="03-finetuning-ggplot_files/figure-html/using%20another%20variable%20to%20order%20a%20factor-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="facets-with-different-category-orders" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Facets with Different Category-Orders<a href="fine-tuning-publication-quality-ggplots.html#facets-with-different-category-orders" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You’ll notice that our reordered categorical axes still have the same order across all of the plots. This would be true even if we changed our <code>group_by()</code> call and used within-product sums to calculate <code>level</code>s. The order is based on factor levels for a single column, and <code>Fresh_Apples</code> can’t be “more than” <code>Dry</code> in one part of the column and “less than” in another part.</p>
<p>On its own, <code>facet_wrap(..., scales = "free")</code> can drop unneeded attributes from plots, but it will still keep the same <em>order</em> of the attributes across all axes.</p>
<p>If you have a faceted plot and you want each facet to have a different ordering of the terms, like in our big penalty analysis example, you’ll have to use <code>tidytext::reorder_within()</code>, <code>tidytext::scale_*_reordered()</code>, <em>and</em> <code>facet_wrap(..., scales = "free")</code>, all at once:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="fine-tuning-publication-quality-ggplots.html#cb70-1" tabindex="-1"></a>long_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="fine-tuning-publication-quality-ggplots.html#cb70-2" tabindex="-1"></a>  <span class="co"># Counting the number of times each attribute is used across all products:</span></span>
<span id="cb70-3"><a href="fine-tuning-publication-quality-ggplots.html#cb70-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Sample_Name, Temperature, cata_variable) <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="fine-tuning-publication-quality-ggplots.html#cb70-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Product =</span> <span class="fu">str_c</span>(Sample_Name, <span class="st">&quot; (&quot;</span>, Temperature, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb70-5"><a href="fine-tuning-publication-quality-ggplots.html#cb70-5" tabindex="-1"></a>         <span class="at">variable_count =</span> <span class="fu">sum</span>(checked),</span>
<span id="cb70-6"><a href="fine-tuning-publication-quality-ggplots.html#cb70-6" tabindex="-1"></a>         <span class="at">cata_variable =</span> tidytext<span class="sc">::</span><span class="fu">reorder_within</span>(cata_variable,</span>
<span id="cb70-7"><a href="fine-tuning-publication-quality-ggplots.html#cb70-7" tabindex="-1"></a>                                                  <span class="at">by =</span> variable_count,</span>
<span id="cb70-8"><a href="fine-tuning-publication-quality-ggplots.html#cb70-8" tabindex="-1"></a>                                                  <span class="at">within =</span> <span class="fu">list</span>(Sample_Name, Temperature))) <span class="sc">%&gt;%</span></span>
<span id="cb70-9"><a href="fine-tuning-publication-quality-ggplots.html#cb70-9" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-10"><a href="fine-tuning-publication-quality-ggplots.html#cb70-10" tabindex="-1"></a>  <span class="fu">filter</span>(checked <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-11"><a href="fine-tuning-publication-quality-ggplots.html#cb70-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cata_variable)) <span class="sc">+</span></span>
<span id="cb70-12"><a href="fine-tuning-publication-quality-ggplots.html#cb70-12" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb70-13"><a href="fine-tuning-publication-quality-ggplots.html#cb70-13" tabindex="-1"></a>  tidytext<span class="sc">::</span><span class="fu">scale_x_reordered</span>() <span class="sc">+</span></span>
<span id="cb70-14"><a href="fine-tuning-publication-quality-ggplots.html#cb70-14" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb70-15"><a href="fine-tuning-publication-quality-ggplots.html#cb70-15" tabindex="-1"></a>  <span class="co"># This will not work with facet_grid, because it forces all plots in a row to</span></span>
<span id="cb70-16"><a href="fine-tuning-publication-quality-ggplots.html#cb70-16" tabindex="-1"></a>  <span class="co"># share a vertical axis, even with scales = &quot;free&quot;</span></span>
<span id="cb70-17"><a href="fine-tuning-publication-quality-ggplots.html#cb70-17" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Product,</span>
<span id="cb70-18"><a href="fine-tuning-publication-quality-ggplots.html#cb70-18" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="03-finetuning-ggplot_files/figure-html/tidytext%20reordering%20within%20facets-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="putting-it-all-together" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Putting it all together<a href="fine-tuning-publication-quality-ggplots.html#putting-it-all-together" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, at long last, we’re ready to walk line-by-line through the example penalty analysis figure that we’ve just been copy-pasting so far in the workshop.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="fine-tuning-publication-quality-ggplots.html#cb71-1" tabindex="-1"></a>berry_penalty_analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="fine-tuning-publication-quality-ggplots.html#cb71-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>count) <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="fine-tuning-publication-quality-ggplots.html#cb71-3" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> checked,</span>
<span id="cb71-4"><a href="fine-tuning-publication-quality-ggplots.html#cb71-4" tabindex="-1"></a>              <span class="at">values_from =</span> penalty_lift,</span>
<span id="cb71-5"><a href="fine-tuning-publication-quality-ggplots.html#cb71-5" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">&quot;checked_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-6"><a href="fine-tuning-publication-quality-ggplots.html#cb71-6" tabindex="-1"></a>  <span class="fu">separate</span>(cata_variable, </span>
<span id="cb71-7"><a href="fine-tuning-publication-quality-ggplots.html#cb71-7" tabindex="-1"></a>           <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;mode&quot;</span>, <span class="st">&quot;variable&quot;</span>), </span>
<span id="cb71-8"><a href="fine-tuning-publication-quality-ggplots.html#cb71-8" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-9"><a href="fine-tuning-publication-quality-ggplots.html#cb71-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">penalty_lift =</span> checked_1 <span class="sc">-</span> checked_0,</span>
<span id="cb71-10"><a href="fine-tuning-publication-quality-ggplots.html#cb71-10" tabindex="-1"></a>         <span class="at">mode =</span> <span class="fu">case_when</span>(mode <span class="sc">==</span> <span class="st">&quot;taste&quot;</span> <span class="sc">~</span> <span class="st">&quot;(T)&quot;</span>,</span>
<span id="cb71-11"><a href="fine-tuning-publication-quality-ggplots.html#cb71-11" tabindex="-1"></a>                          mode <span class="sc">==</span> <span class="st">&quot;appearance&quot;</span> <span class="sc">~</span> <span class="st">&quot;(A)&quot;</span>,</span>
<span id="cb71-12"><a href="fine-tuning-publication-quality-ggplots.html#cb71-12" tabindex="-1"></a>                          mode <span class="sc">==</span> <span class="st">&quot;appearane&quot;</span> <span class="sc">~</span> <span class="st">&quot;(A)&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb71-13"><a href="fine-tuning-publication-quality-ggplots.html#cb71-13" tabindex="-1"></a>  <span class="fu">unite</span>(variable, mode, <span class="at">col =</span> <span class="st">&quot;cata_variable&quot;</span>, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-14"><a href="fine-tuning-publication-quality-ggplots.html#cb71-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cata_variable =</span> tidytext<span class="sc">::</span><span class="fu">reorder_within</span>(<span class="at">x =</span> cata_variable,</span>
<span id="cb71-15"><a href="fine-tuning-publication-quality-ggplots.html#cb71-15" tabindex="-1"></a>                                                  <span class="at">by =</span> penalty_lift,</span>
<span id="cb71-16"><a href="fine-tuning-publication-quality-ggplots.html#cb71-16" tabindex="-1"></a>                                                  <span class="at">within =</span> berry)) <span class="sc">%&gt;%</span></span>
<span id="cb71-17"><a href="fine-tuning-publication-quality-ggplots.html#cb71-17" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cata_variable, <span class="at">y =</span> penalty_lift)) <span class="sc">+</span></span>
<span id="cb71-18"><a href="fine-tuning-publication-quality-ggplots.html#cb71-18" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> penalty_lift), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb71-19"><a href="fine-tuning-publication-quality-ggplots.html#cb71-19" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>berry, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb71-20"><a href="fine-tuning-publication-quality-ggplots.html#cb71-20" tabindex="-1"></a>  tidytext<span class="sc">::</span><span class="fu">scale_x_reordered</span>() <span class="sc">+</span> </span>
<span id="cb71-21"><a href="fine-tuning-publication-quality-ggplots.html#cb71-21" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb71-22"><a href="fine-tuning-publication-quality-ggplots.html#cb71-22" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb71-23"><a href="fine-tuning-publication-quality-ggplots.html#cb71-23" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;tan&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span> </span>
<span id="cb71-24"><a href="fine-tuning-publication-quality-ggplots.html#cb71-24" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb71-25"><a href="fine-tuning-publication-quality-ggplots.html#cb71-25" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Penalty / Lift Analysis&quot;</span>,</span>
<span id="cb71-26"><a href="fine-tuning-publication-quality-ggplots.html#cb71-26" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;displays the mean difference (within berries) for when a CATA variable is checked</span><span class="sc">\n</span><span class="st">or un-checked&quot;</span>)</span></code></pre></div>
<p><img src="03-finetuning-ggplot_files/figure-html/final%20walkthrough%20of%20penalty%20analysis-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-basics-of-plotting-with-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-ggplot-with-other-packages.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
