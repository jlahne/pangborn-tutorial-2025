<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 The basics of plotting with ggplot2 | Publication-quality data visualizations using the R tidyverse</title>
  <meta name="description" content="3 The basics of plotting with ggplot2 | Publication-quality data visualizations using the R tidyverse" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="3 The basics of plotting with ggplot2 | Publication-quality data visualizations using the R tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="lhami/sensometrics-tutorial-2024" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 The basics of plotting with ggplot2 | Publication-quality data visualizations using the R tidyverse" />
  
  
  

<meta name="author" content="Jacob Lahne" />
<meta name="author" content="Leah Hamilton" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="importing-and-wrangling-data.html"/>
<link rel="next" href="using-ggplot-with-other-packages.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction and welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#introductions"><i class="fa fa-check"></i>Introductions</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#leah-hamilton-phd"><i class="fa fa-check"></i>Leah Hamilton, PhD</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#jacob-lahne-phd"><i class="fa fa-check"></i>Jacob Lahne, PhD</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#todays-agenda"><i class="fa fa-check"></i>Today’s agenda</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-were-going-to-run"><i class="fa fa-check"></i>How we’re going to run</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#recommended-approach-for-livecoding"><i class="fa fa-check"></i>Recommended approach for livecoding</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dealing-with-errors"><i class="fa fa-check"></i>Dealing with errors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#psa-not-knowing-is-normal"><i class="fa fa-check"></i>PSA: not-knowing is normal!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i>Getting Help</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> A crash course in <code>R</code> and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#r-vs-rstudio"><i class="fa fa-check"></i><b>1.1</b> <code>R</code> vs RStudio</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#what-is-r"><i class="fa fa-check"></i><b>1.1.1</b> What is <code>R</code>?</a></li>
<li class="chapter" data-level="1.1.2" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#great-why-are-we-using-rstudio-then"><i class="fa fa-check"></i><b>1.1.2</b> Great, why are we using RStudio then?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#the-parts-of-rstudio"><i class="fa fa-check"></i><b>1.2</b> The parts of RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#the-working-directory-and-why-you-should-care"><i class="fa fa-check"></i><b>1.2.1</b> The “working directory” and why you should care</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#extending-r-with-packages"><i class="fa fa-check"></i><b>1.3</b> Extending <code>R</code> with packages</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#loading-packages"><i class="fa fa-check"></i><b>1.3.1</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#making-r-do-stuff"><i class="fa fa-check"></i><b>1.4</b> Making <code>R</code> do stuff</a></li>
<li class="chapter" data-level="1.5" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#livecoding-along"><i class="fa fa-check"></i><b>1.5</b> Livecoding along</a></li>
<li class="chapter" data-level="1.6" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#summary-and-next-steps"><i class="fa fa-check"></i><b>1.6</b> Summary and next steps</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html"><i class="fa fa-check"></i><b>2</b> Importing and wrangling data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#motivation-exploring-berry-and-cider-cataliking-data"><i class="fa fa-check"></i><b>2.1</b> Motivation: exploring berry and cider CATA/liking data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#berries"><i class="fa fa-check"></i><b>2.1.1</b> Berries</a></li>
<li class="chapter" data-level="2.1.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#cider"><i class="fa fa-check"></i><b>2.1.2</b> Cider</a></li>
<li class="chapter" data-level="2.1.3" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#publication-quality"><i class="fa fa-check"></i><b>2.1.3</b> “Publication quality”</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#getting-data-into-r"><i class="fa fa-check"></i><b>2.2</b> Getting data into <code>R</code></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#where-the-data-live"><i class="fa fa-check"></i><b>2.2.1</b> Where the data live</a></li>
<li class="chapter" data-level="2.2.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#getting-different-kinds-of-files-into-r"><i class="fa fa-check"></i><b>2.2.2</b> Getting different kinds of files into <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#wrangling-selecting-filtering-reshaping-data"><i class="fa fa-check"></i><b>2.3</b> Wrangling (selecting, filtering, reshaping) data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#the-pipe-for-multiple-steps-in-a-workflow"><i class="fa fa-check"></i><b>2.3.1</b> The “pipe” for multiple steps in a workflow: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#subsetting-your-data"><i class="fa fa-check"></i><b>2.3.2</b> Subsetting your data</a></li>
<li class="chapter" data-level="2.3.3" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#reshaping-your-data"><i class="fa fa-check"></i><b>2.3.3</b> Reshaping your data</a></li>
<li class="chapter" data-level="2.3.4" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#some-convenience-functions"><i class="fa fa-check"></i><b>2.3.4</b> Some convenience functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#saving-your-data"><i class="fa fa-check"></i><b>2.4</b> Saving your data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#a-note-on-replicability"><i class="fa fa-check"></i><b>2.4.1</b> A note on replicability</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#wrap-up"><i class="fa fa-check"></i><b>2.5</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>3</b> The basics of plotting with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#your-first-ggplot"><i class="fa fa-check"></i><b>3.1</b> Your first <code>ggplot()</code></a></li>
<li class="chapter" data-level="3.2" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#the-aes-function-and-mapping-argument"><i class="fa fa-check"></i><b>3.2</b> The <code>aes()</code> function and <code>mapping =</code> argument</a></li>
<li class="chapter" data-level="3.3" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#adding-layers-with-geom_-functions"><i class="fa fa-check"></i><b>3.3</b> Adding layers with <code>geom_*()</code> functions</a></li>
<li class="chapter" data-level="3.4" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#arguments-inside-and-outside-of-aes"><i class="fa fa-check"></i><b>3.4</b> Arguments inside and outside of <code>aes()</code></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#using-theme_-to-change-visual-options-quickly"><i class="fa fa-check"></i><b>3.4.1</b> Using <code>theme_*()</code> to change visual options quickly</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#changing-aesthetic-elements-with-scale_-functions"><i class="fa fa-check"></i><b>3.4.2</b> Changing aesthetic elements with <code>scale_*()</code> functions</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#finally-facet_"><i class="fa fa-check"></i><b>3.4.3</b> Finally, <code>facet_*()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#some-further-reading"><i class="fa fa-check"></i><b>3.5</b> Some further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html"><i class="fa fa-check"></i><b>4</b> Using ggplot with Other Packages</a>
<ul>
<li class="chapter" data-level="4.1" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#data-for-the-rest-of-the-tutorial"><i class="fa fa-check"></i><b>4.1</b> Data for the rest of the tutorial</a></li>
<li class="chapter" data-level="4.2" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#new-geom_s-and-stat_s"><i class="fa fa-check"></i><b>4.2</b> New <code>geom_*()s</code> and <code>stat_*()</code>s</a></li>
<li class="chapter" data-level="4.3" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#new-theme_s-and-scale_s"><i class="fa fa-check"></i><b>4.3</b> New <code>theme_*()</code>s and <code>scale_*()</code>s</a></li>
<li class="chapter" data-level="4.4" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#modifying-ggplots-made-by-other-packages"><i class="fa fa-check"></i><b>4.4</b> Modifying <code>ggplot()</code>s made by other packages</a></li>
<li class="chapter" data-level="4.5" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#combining-plots"><i class="fa fa-check"></i><b>4.5</b> Combining Plots</a></li>
<li class="chapter" data-level="4.6" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#finding-new-packages"><i class="fa fa-check"></i><b>4.6</b> Finding New Packages</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html"><i class="fa fa-check"></i><b>5</b> Fine-Tuning Publication-Quality ggplots</a>
<ul>
<li class="chapter" data-level="5.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#exporting-and-saving-plots"><i class="fa fa-check"></i><b>5.1</b> Exporting and Saving Plots</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#what-format"><i class="fa fa-check"></i><b>5.1.1</b> What format?</a></li>
<li class="chapter" data-level="5.1.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#ggsave"><i class="fa fa-check"></i><b>5.1.2</b> Exporting Images with <code>ggsave()</code></a></li>
<li class="chapter" data-level="5.1.3" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#other-image-export-options"><i class="fa fa-check"></i><b>5.1.3</b> Other Image Export Options</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#making-text-look-okay"><i class="fa fa-check"></i><b>5.2</b> Making Text Look Okay</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#powerful-text-manipulation-with-stringr"><i class="fa fa-check"></i><b>5.2.1</b> Powerful Text Manipulation with <code>stringr</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#removing-legends-and-plot-elements"><i class="fa fa-check"></i><b>5.3</b> Removing Legends and Plot Elements</a></li>
<li class="chapter" data-level="5.4" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#ordered-categorical-variables"><i class="fa fa-check"></i><b>5.4</b> Ordered Categorical Variables</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#specifying-ordinal-variables-as-factors"><i class="fa fa-check"></i><b>5.4.1</b> Specifying Ordinal Variables as Factors</a></li>
<li class="chapter" data-level="5.4.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#facets-with-different-category-orders"><i class="fa fa-check"></i><b>5.4.2</b> Facets with Different Category-Orders</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#putting-it-all-together"><i class="fa fa-check"></i><b>5.5</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html"><i class="fa fa-check"></i><b>6</b> Wrap-up and further resources</a>
<ul>
<li class="chapter" data-level="6.1" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#getting-help-1"><i class="fa fa-check"></i><b>6.1</b> Getting help</a></li>
<li class="chapter" data-level="6.2" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#further-readingresources"><i class="fa fa-check"></i><b>6.2</b> Further reading/resources</a></li>
<li class="chapter" data-level="6.3" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#questionscomments"><i class="fa fa-check"></i><b>6.3</b> Questions/Comments</a></li>
<li class="chapter" data-level="6.4" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#references"><i class="fa fa-check"></i><b>6.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#ggresolution"><i class="fa fa-check"></i>Image Sizes and Raster Resolutions</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#simpler-sizing-vector-images"><i class="fa fa-check"></i>Simpler Sizing: Vector Images</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#raster-image-resolutions"><i class="fa fa-check"></i>Raster Image Resolutions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#regex"><i class="fa fa-check"></i>Regular Expressions</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Publication-quality data visualizations using the R tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-basics-of-plotting-with-ggplot2" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> The basics of plotting with <code>ggplot2</code><a href="the-basics-of-plotting-with-ggplot2.html#the-basics-of-plotting-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Base <code>R</code> includes extremely powerful utilities for data visualization, but most modern applications make use of the <code>tidyverse</code> package <code>ggplot2</code>.</p>
<p>A quick word about base <code>R</code> plotting–I don’t mean to declare that you can’t use base <code>R</code> plotting for your projects at all, and I have published several papers using base <code>R</code> plots. Particularly as you are using <code>R</code> for your own data exploration (not meant for sharing outside your team, say), base utilities like <code>plot()</code> will be very useful for quick insight.</p>
<p><code>ggplot2</code> provides a standardized, programmatic interface for data visualization, in contrast to the piecemeal approach common to base <code>R</code> graphics plotting. This means that, while the syntax itself can be challenging to learn, syntax for different tasks is linked by a common vocabulary, and differs in logical and predictable ways.</p>
<p>Together with other <code>tidyverse</code> principles (like <code>select()</code> and <code>filter()</code> approaches), <code>ggplot2</code> makes it easy to make publication-quality visualizations with relative ease.</p>
<p>In general, <code>ggplot2</code> works best with data in “long” or “tidy” format, such as that resulting from the output of <code>pivot_longer()</code>. The</p>
<p>The schematic elements of a ggplot are as follows:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb89-1" tabindex="-1"></a><span class="co"># The ggplot() function creates your plotting environment.  We usually save it to a variable in R so that we can use the plug-n-play functionality of ggplot without retyping a bunch of nonsense</span></span>
<span id="cb89-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb89-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">&lt;</span>a variable<span class="sc">&gt;</span>, <span class="at">y =</span> <span class="sc">&lt;</span>another variable<span class="sc">&gt;</span>, ...),</span>
<span id="cb89-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb89-3" tabindex="-1"></a>            <span class="at">data =</span> <span class="sc">&lt;</span>your data<span class="sc">&gt;</span>)</span>
<span id="cb89-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb89-4" tabindex="-1"></a></span>
<span id="cb89-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb89-5" tabindex="-1"></a><span class="co"># Then, you can add various ways of plotting data to make different visualizations.</span></span>
<span id="cb89-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb89-6" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb89-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb89-7" tabindex="-1"></a>  geom_<span class="sc">&lt;</span>your chosen way of plotting<span class="sc">&gt;</span>(...) <span class="sc">+</span></span>
<span id="cb89-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb89-8" tabindex="-1"></a>  theme_<span class="sc">&lt;</span>your chosen theme<span class="sc">&gt;</span> <span class="sc">+</span></span>
<span id="cb89-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb89-9" tabindex="-1"></a>  ...</span></code></pre></div>
<p>In graphical form, the following diagram (<a href="https://vt-hydroinformatics.github.io/Plotting.html#our-first-ggplot">from VT Professor JP Gannon</a>) gives an intuition of what is happening:</p>
<div class="float">
<img src="img/GGplot%20syntax.png" alt="Basic ggplot mappings. Color boxes indicate where the elements go in the function and in the plot." />
<div class="figcaption">Basic ggplot mappings. Color boxes indicate where the elements go in the function and in the plot.</div>
</div>
<div id="your-first-ggplot" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Your first <code>ggplot()</code><a href="the-basics-of-plotting-with-ggplot2.html#your-first-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our cider data is already relatively tidy and is much easier to visually inspect, so we will be primarily using it in this section.</p>
<p>Let’s begin by making an example <code>ggplot()</code> to demonstrate how it works.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb90-1" tabindex="-1"></a><span class="co"># We start with our data and pipe it into ggplot</span></span>
<span id="cb90-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb90-2" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb90-3" tabindex="-1"></a>  <span class="co"># Here we set up the base plot</span></span>
<span id="cb90-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb90-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> MerlynScale_Ranking, <span class="at">y =</span> Liking)) <span class="sc">+</span> </span>
<span id="cb90-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb90-5" tabindex="-1"></a>   <span class="co"># Here we tell our base plot to add points</span></span>
<span id="cb90-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb90-6" tabindex="-1"></a>  <span class="fu">geom_point</span>()                          </span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/a%20first%20ggplot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This doesn’t look all that impressive–partly because the data being plotted itself isn’t that sensible, and partly because we haven’t made many changes. But before we start looking into that, let’s break down the parts of this command.</p>
</div>
<div id="the-aes-function-and-mapping-argument" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> The <code>aes()</code> function and <code>mapping =</code> argument<a href="the-basics-of-plotting-with-ggplot2.html#the-aes-function-and-mapping-argument" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>ggplot()</code> function takes two arguments that are essential, as well as some others you’ll rarely use. The first, <code>data =</code>, is straightforward, and you’ll usually be passing data to the function at the end of some pipeline using <code>%&gt;%</code></p>
<p>The second, <code>mapping =</code>, is less clear. This argument requires the <code>aes()</code> function, which can be read as the “aesthetic” function. The way that this function works is quite complex, and really not worth digging into here, but I understand it in my head as <strong>telling <code>ggplot()</code> what part of my data is going to connect to what part of the plot</strong>. So, if we write <code>aes(x = MerlynScale_Ranking)</code>, we can read this in our heads as “the values of x will be mapped from the ‘MerlynScale_Ranking’ column”.</p>
<p>This sentence tells us the other important thing about <code>ggplot()</code> and the <code>aes()</code> mappings: <strong>mapped variables each have to be in their own column</strong>. This is another reason that <code>ggplot()</code> requires tidy data.</p>
</div>
<div id="adding-layers-with-geom_-functions" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Adding layers with <code>geom_*()</code> functions<a href="the-basics-of-plotting-with-ggplot2.html#adding-layers-with-geom_-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the above example, we added (literally, using <code>+</code>) a function called <code>geom_point()</code> to the base <code>ggplot()</code> call. This is functionally a “layer” of our plot, that tells <code>ggplot2</code> how to actually visualize the elements specified in the <code>aes()</code> function–in the case of <code>geom_point()</code>, we create a point for each row’s combination of <code>x = MerlynScale_Ranking</code> and <code>y = Liking</code>.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb91-1" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb91-2" tabindex="-1"></a>  <span class="fu">select</span>(MerlynScale_Ranking, Liking)</span></code></pre></div>
<pre><code>## # A tibble: 288 × 2
##    MerlynScale_Ranking Liking
##                  &lt;dbl&gt;  &lt;dbl&gt;
##  1                 2.3      6
##  2                 3.5      7
##  3                 2.8      4
##  4                 4.2      2
##  5                 2        7
##  6                 4        5
##  7                 3        8
##  8                 3.3      6
##  9                 3.5      7
## 10                 4.5      3
## # ℹ 278 more rows</code></pre>
<p>There are many <code>geom_*()</code> functions in <code>ggplot2</code>, and many others defined in other accessory packages. These are the heart of visualizations. We can swap them out to get different results:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb93-1" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb93-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> MerlynScale_Ranking, <span class="at">y =</span> Liking)) <span class="sc">+</span> </span>
<span id="cb93-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb93-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/switching%20geom%20switches%20the%20way%20the%20data%20map-1.png" width="672" style="display: block; margin: auto;" />
Here we fit a smoothed line to our data using the default methods in <code>geom_smooth()</code> (which in this case heuristically defaults to a spline model with LOESS smoothing, but could be linear, GAM, etc).</p>
<p>We can also combine layers, as the term “layer” implies:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb94-1" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb94-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> MerlynScale_Ranking, <span class="at">y =</span> Liking)) <span class="sc">+</span> </span>
<span id="cb94-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb94-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="co"># add some random noise to show overlapping points</span></span>
<span id="cb94-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb94-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/geoms%20are%20layers%20in%20a%20plot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note that we don’t need to tell <em>either</em> <code>geom_smooth()</code> or <code>geom_jitter()</code> what <code>x</code> and <code>y</code> are–they “inherit” them from the <code>ggplot()</code> function to which they are added (<code>+</code>), which defines the plot itself.</p>
<p>What other arguments can be set to aesthetics? Well, we can set other visual properties like <strong>color</strong>, <strong>size</strong>, <strong>transparency</strong> (called “alpha”), and so on. For example, let’s try to look at whether there is a relationship between whether a cider is perceived as “Dry” through CATA, measured as “Dry” (low values) on the Merlyn Scale, and overall liking.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb95-1" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb95-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dry =</span> <span class="fu">as.factor</span>(Dry)) <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb95-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> MerlynScale_Ranking, <span class="at">y =</span> Liking, <span class="at">color =</span> Dry)) <span class="sc">+</span></span>
<span id="cb95-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb95-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb95-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb95-5" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkorange&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb95-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb95-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/here%20are%20some%20other%20parts%20of%20the%20plot%20we%20can%20control%20with%20data-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can see that most of the orange dots are to the left side of the figure (associated with lower Merlyn scale ratings), and that most of th3e blue dots are to the right (associated with higher Merlyn Scale ratings). It’s hard to make sense of patterns of liking in this visualization, but it looks like “Dry” CATA checks may have somewhat lower liking ratings overall.</p>
</div>
<div id="arguments-inside-and-outside-of-aes" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Arguments inside and outside of <code>aes()</code><a href="the-basics-of-plotting-with-ggplot2.html#arguments-inside-and-outside-of-aes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the last plot, we saw an example in the <code>geom_jitter(alpha = 1/2)</code> function of setting the <code>alpha</code> (transparency) aesthetic element directly, without using <code>aes()</code> to <strong>map</strong> a variable to this aesthetic. That is why this is not wrapped in the <code>aes()</code> function. In <code>ggplot2</code>, this is how we set aesthetics to fixed values.</p>
<p>If we had a value we wanted to map transparency to, we would set <code>aes(alpha = &lt;variable&gt;)</code>. In this dataset, I can’t think of a good option for alpha, but note that we can set any variable in these two ways:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb96-1" tabindex="-1"></a><span class="co"># First, here is the previous figure, showing how we can set aesthetics</span></span>
<span id="cb96-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb96-2" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb96-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dry =</span> <span class="fu">as.factor</span>(Dry)) <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb96-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MerlynScale_Ranking, <span class="at">y =</span> Liking)) <span class="sc">+</span> </span>
<span id="cb96-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb96-5" tabindex="-1"></a>  <span class="co"># We can set new aes() mappings in individual layers, as well as the plot itself</span></span>
<span id="cb96-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb96-6" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> Dry)) <span class="sc">+</span> </span>
<span id="cb96-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb96-7" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkorange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb96-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb96-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/using%20the%20aes%20function-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb97-1" tabindex="-1"></a><span class="co"># And now we manually set a color for our points: note this means our color</span></span>
<span id="cb97-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb97-2" tabindex="-1"></a><span class="co"># WON&#39;T change with different values of a variable.</span></span>
<span id="cb97-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb97-3" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb97-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb97-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dry =</span> <span class="fu">as.factor</span>(Dry)) <span class="sc">%&gt;%</span></span>
<span id="cb97-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb97-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MerlynScale_Ranking, <span class="at">y =</span> Liking)) <span class="sc">+</span> </span>
<span id="cb97-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb97-6" tabindex="-1"></a>  <span class="co"># notice we no longer use aes() below, and color no longer matches `Dry`</span></span>
<span id="cb97-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb97-7" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">color =</span> <span class="st">&quot;darkorange&quot;</span>) <span class="sc">+</span> </span>
<span id="cb97-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb97-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/using%20the%20aes%20function-2.png" width="672" style="display: block; margin: auto;" /></p>
<div id="using-theme_-to-change-visual-options-quickly" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Using <code>theme_*()</code> to change visual options quickly<a href="the-basics-of-plotting-with-ggplot2.html#using-theme_-to-change-visual-options-quickly" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the last several plots, notice that we have changed from the default (and to my mind unattractive) grey background of <code>ggplot2</code> to a black and white theme. This is by adding a <code>theme_bw()</code> call to the list of commands. <code>ggplot2</code> includes a number of default <code>theme_*()</code> functions, and you can get many more through other <code>R</code> packages. They can have subtle to dramatic effects:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb98-1" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb98-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MerlynScale_Ranking, <span class="at">y =</span> Liking)) <span class="sc">+</span> </span>
<span id="cb98-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb98-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb98-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb98-4" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/using%20the%20theme%20functions-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can edit every last element of the plot’s theme using the base <code>theme()</code> function, which is powerful but a little bit tricky to use.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb99-1" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb99-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MerlynScale_Ranking, <span class="at">y =</span> Liking)) <span class="sc">+</span> </span>
<span id="cb99-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb99-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb99-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb99-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb99-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb99-5" tabindex="-1"></a>  <span class="co"># we use theme() to remove grid lines, for example</span></span>
<span id="cb99-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb99-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/using%20theme-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Most of the use of <code>theme()</code> involves functions names as <code>element_*()</code>. When we remove elements, for example, we use <code>element_blank()</code> (not, for example, <code>NA</code> or <code>NULL</code> as we typically would in other parts of <code>R</code>).</p>
<p>Finally, we can set default themes for a particular script using the <code>theme_set()</code> function. We can also use this to set custom defaults:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb100-1" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb100-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb100-2" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb100-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb100-3" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb100-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb100-4" tabindex="-1"></a>)</span>
<span id="cb100-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb100-5" tabindex="-1"></a></span>
<span id="cb100-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb100-6" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb100-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb100-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MerlynScale_Ranking, <span class="at">y =</span> Liking)) <span class="sc">+</span> </span>
<span id="cb100-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb100-8" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>All plots from here on will <em>default</em> to the <code>theme_bw()</code> theme, with the “minor” grid lines removed for a cleaner grid look.</p>
</div>
<div id="changing-aesthetic-elements-with-scale_-functions" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Changing aesthetic elements with <code>scale_*()</code> functions<a href="the-basics-of-plotting-with-ggplot2.html#changing-aesthetic-elements-with-scale_-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, say we didn’t like the default color set for the points.</p>
<p>How can we manipulate the colors that are plotted? The <strong>way in which</strong> mapped, aesthetic variables are assigned to visual elements is controlled by the <code>scale_*()</code> functions.</p>
<p>In my experience, the most frequently encountered scales are those for color: either <code>scale_fill_*()</code> for solid objects (like the bars in a histogram) or <code>scale_color_*()</code> for lines and points (like the outlines of the histogram bars).</p>
<p>Scale functions work by telling <code>ggplot()</code> <em>how</em> to map aesthetic variables to visual elements. You may have noticed that I added a <code>scale_color_manual()</code> function to the end of several plots above. This function lets me manually specify the colors that are assigned to each colored element.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb101-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> </span>
<span id="cb101-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb101-2" tabindex="-1"></a>  raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb101-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dry =</span> <span class="fu">as.factor</span>(Dry)) <span class="sc">%&gt;%</span></span>
<span id="cb101-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb101-4" tabindex="-1"></a>  <span class="co"># This block gets us a subset of beer styles for clear visualization</span></span>
<span id="cb101-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb101-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Liking)) <span class="sc">+</span> </span>
<span id="cb101-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb101-6" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Dry), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb101-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb101-7" tabindex="-1"></a></span>
<span id="cb101-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb101-8" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/ggplots%20are%20R%20objects-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can take a saved plot (like <code>p</code>) and use scales to change how it is visualized.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb102-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>()</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/we%20can%20modify%20stored%20plots%20after%20the%20fact-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><code>ggplot2</code> has a broad range of built-in options for scales, but there are many others available in add-on packages that build on top of it. The <code>scale_*_viridis_*()</code> functions use a package callled <code>viridis</code> that provides (theoretically) color-blind safe colors for both continuous (gradient) and categorical (discrete) mappings, but I do find that their defaults (using light colors like yellow on one end of the scale) are hard to see for anyone!</p>
<p>As we saw above, you can also build your own scales using the <code>scale_*_manual()</code> functions, in which you give a vector of the same length as your mapped aesthetic variable in order to set up the visual assignment. That sounds jargon-y, so here is an example:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb103-1" tabindex="-1"></a><span class="co"># We&#39;ll pick 14 random colors from the colors R knows about</span></span>
<span id="cb103-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb103-2" tabindex="-1"></a>random_colors <span class="ot">&lt;-</span> <span class="fu">print</span>(<span class="fu">colors</span>()[<span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">colors</span>()), <span class="at">size =</span> <span class="dv">10</span>)])</span></code></pre></div>
<pre><code>##  [1] &quot;gray95&quot;         &quot;gray33&quot;         &quot;blueviolet&quot;     &quot;peachpuff2&quot;    
##  [5] &quot;grey99&quot;         &quot;green&quot;          &quot;grey74&quot;         &quot;grey44&quot;        
##  [9] &quot;chocolate4&quot;     &quot;paleturquoise2&quot;</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb105-1" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb105-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb105-2" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> random_colors)</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/another%20example%20of%20posthoc%20plot%20modification-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="finally-facet_" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Finally, <code>facet_*()</code><a href="the-basics-of-plotting-with-ggplot2.html#finally-facet_" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The last powerful tool I want to show off is the ability of <code>ggplot2</code> to make what <a href="https://socviz.co/groupfacettx.html#facet-to-make-small-multiples">Edward Tufte called “small multiples”</a>: breaking out the data into multiple, identical plots by some categorical classifier in order to show trends more effectively.</p>
<p>So far we’ve seen how to visualize the overall liking of ciders in our small data set by the Merlyn Scale Ranking, and how to assign color, transparency, and fill to other attributes. We can use such an approach to get a quick picture of the CATA selections for each cider in a clear, easy to see visualization:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb106-1" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb106-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Fresh_Apples<span class="sc">:</span>Synthetic) <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb106-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Sample_Name, Temperature, name) <span class="sc">%&gt;%</span></span>
<span id="cb106-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb106-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">sum</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb106-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb106-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">interaction</span>(Sample_Name, Temperature), <span class="at">y =</span> total)) <span class="sc">+</span> </span>
<span id="cb106-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb106-6" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Sample_Name)) <span class="sc">+</span></span>
<span id="cb106-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb106-7" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> wesanderson<span class="sc">::</span>wes_palettes<span class="sc">$</span>FantasticFox1) <span class="sc">+</span> </span>
<span id="cb106-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb106-8" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb106-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb106-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb106-10"><a href="the-basics-of-plotting-with-ggplot2.html#cb106-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb106-11"><a href="the-basics-of-plotting-with-ggplot2.html#cb106-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/cider-facets-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can see that overall for the most frequently used attributes, the serving temperature doesn’t matter (and for the most part there is some reassuring consistency in the use of terms to describe each cider at different temperatures).</p>
<p>But in the previous part of this workshop, we showed much more complex plots for our berry data, which showed the same plot broken up by a classifying variable: this is called “faceting”. Let’s return from our cider data to our berry data in order to finally complete the workflow I showed in the beginning of the workshop.</p>
<p>Now we are prepared to walk through the entire workflow</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-1" tabindex="-1"></a><span class="co"># First we wrangle our data using the tools we&#39;ve learned to get penalties/lifts</span></span>
<span id="cb107-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-2" tabindex="-1"></a><span class="co"># for each attributes</span></span>
<span id="cb107-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-3" tabindex="-1"></a>berry_penalty_analysis_data <span class="ot">&lt;-</span> </span>
<span id="cb107-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-4" tabindex="-1"></a>  berry_long_cata <span class="sc">%&gt;%</span></span>
<span id="cb107-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-5" tabindex="-1"></a>  <span class="fu">group_by</span>(berry, cata_variable, checked) <span class="sc">%&gt;%</span></span>
<span id="cb107-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-6" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">penalty_lift =</span> <span class="fu">mean</span>(rating),</span>
<span id="cb107-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-7" tabindex="-1"></a>            <span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb107-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-8" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb107-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-9" tabindex="-1"></a></span>
<span id="cb107-10"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-10" tabindex="-1"></a>p1_berry_penalty <span class="ot">&lt;-</span> </span>
<span id="cb107-11"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-11" tabindex="-1"></a>  </span>
<span id="cb107-12"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-12" tabindex="-1"></a>  <span class="co"># We start by widening our data just a bit, and use a function to give some</span></span>
<span id="cb107-13"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-13" tabindex="-1"></a>  <span class="co"># better names to our mean values for when an attribute it checked (1) or not</span></span>
<span id="cb107-14"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-14" tabindex="-1"></a>  <span class="co"># (0).</span></span>
<span id="cb107-15"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-15" tabindex="-1"></a>  </span>
<span id="cb107-16"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-16" tabindex="-1"></a>  berry_penalty_analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb107-17"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-17" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>count) <span class="sc">%&gt;%</span></span>
<span id="cb107-18"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-18" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> checked,</span>
<span id="cb107-19"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-19" tabindex="-1"></a>              <span class="at">values_from =</span> penalty_lift,</span>
<span id="cb107-20"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-20" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">&quot;checked_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-21"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-21" tabindex="-1"></a>  </span>
<span id="cb107-22"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-22" tabindex="-1"></a>  <span class="co"># Then we actually calculate the penalty/lift: what is the difference in the</span></span>
<span id="cb107-23"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-23" tabindex="-1"></a>  <span class="co"># mean liking when an attribute is checked or not?</span></span>
<span id="cb107-24"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-24" tabindex="-1"></a>  </span>
<span id="cb107-25"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-25" tabindex="-1"></a>  <span class="fu">group_by</span>(berry, cata_variable) <span class="sc">%&gt;%</span></span>
<span id="cb107-26"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-26" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">penalty_lift =</span> checked_1 <span class="sc">-</span> checked_0) <span class="sc">%&gt;%</span></span>
<span id="cb107-27"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-27" tabindex="-1"></a>  </span>
<span id="cb107-28"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-28" tabindex="-1"></a>  <span class="co"># We have two kinds of CATA attibutes: visual assessment and by-mouth</span></span>
<span id="cb107-29"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-29" tabindex="-1"></a>  <span class="co"># assessment.  It would be nice to keep track.</span></span>
<span id="cb107-30"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-30" tabindex="-1"></a>  </span>
<span id="cb107-31"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-31" tabindex="-1"></a>  <span class="fu">separate</span>(cata_variable, </span>
<span id="cb107-32"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-32" tabindex="-1"></a>           <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;mode&quot;</span>, <span class="st">&quot;variable&quot;</span>), </span>
<span id="cb107-33"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-33" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-34"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-34" tabindex="-1"></a>  </span>
<span id="cb107-35"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-35" tabindex="-1"></a>  <span class="co"># Fix a typo</span></span>
<span id="cb107-36"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-36" tabindex="-1"></a>  </span>
<span id="cb107-37"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-37" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mode =</span> <span class="fu">str_replace</span>(mode, <span class="st">&quot;appearane&quot;</span>, <span class="st">&quot;appearance&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-38"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-38" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mode =</span> <span class="fu">case_when</span>(mode <span class="sc">==</span> <span class="st">&quot;taste&quot;</span> <span class="sc">~</span> <span class="st">&quot;(T)&quot;</span>,</span>
<span id="cb107-39"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-39" tabindex="-1"></a>                          mode <span class="sc">==</span> <span class="st">&quot;appearance&quot;</span> <span class="sc">~</span> <span class="st">&quot;(A)&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-40"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-40" tabindex="-1"></a>  <span class="fu">unite</span>(variable, mode, <span class="at">col =</span> <span class="st">&quot;cata_variable&quot;</span>, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-41"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-41" tabindex="-1"></a>  </span>
<span id="cb107-42"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-42" tabindex="-1"></a>  <span class="co"># We are using a function from tidytext that makes faceting the final figure</span></span>
<span id="cb107-43"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-43" tabindex="-1"></a>  <span class="co"># easier: reorder_within() makes a set of factors able to be ordered</span></span>
<span id="cb107-44"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-44" tabindex="-1"></a>  <span class="co"># differently within another variable.  In this case, we have different</span></span>
<span id="cb107-45"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-45" tabindex="-1"></a>  <span class="co"># attributes and different penalties within each berry by design</span></span>
<span id="cb107-46"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-46" tabindex="-1"></a>  </span>
<span id="cb107-47"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-47" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cata_variable =</span> tidytext<span class="sc">::</span><span class="fu">reorder_within</span>(<span class="at">x =</span> cata_variable,</span>
<span id="cb107-48"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-48" tabindex="-1"></a>                                                  <span class="at">by =</span> penalty_lift,</span>
<span id="cb107-49"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-49" tabindex="-1"></a>                                                  <span class="at">within =</span> berry)) <span class="sc">%&gt;%</span></span>
<span id="cb107-50"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-50" tabindex="-1"></a>  </span>
<span id="cb107-51"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-51" tabindex="-1"></a>  <span class="co">#And finally we plot!</span></span>
<span id="cb107-52"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-52" tabindex="-1"></a>  </span>
<span id="cb107-53"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-53" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cata_variable, <span class="at">y =</span> penalty_lift)) <span class="sc">+</span></span>
<span id="cb107-54"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-54" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> penalty_lift), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb107-55"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-55" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>berry, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb107-56"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-56" tabindex="-1"></a>  </span>
<span id="cb107-57"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-57" tabindex="-1"></a>  <span class="co"># To take advantage of our newly reordered factors, we also need to use the</span></span>
<span id="cb107-58"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-58" tabindex="-1"></a>  <span class="co"># matching tidytext::scale_x_reordered() function</span></span>
<span id="cb107-59"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-59" tabindex="-1"></a>  </span>
<span id="cb107-60"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-60" tabindex="-1"></a>  tidytext<span class="sc">::</span><span class="fu">scale_x_reordered</span>() <span class="sc">+</span> </span>
<span id="cb107-61"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-61" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb107-62"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-62" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb107-63"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-63" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;tan&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span> </span>
<span id="cb107-64"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-64" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb107-65"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-65" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Penalty / Lift Analysis&quot;</span>,</span>
<span id="cb107-66"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-66" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;displays the mean difference (within berries) for when a CATA variable is checked</span><span class="sc">\n</span><span class="st">or un-checked&quot;</span>)</span>
<span id="cb107-67"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-67" tabindex="-1"></a></span>
<span id="cb107-68"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-68" tabindex="-1"></a><span class="co"># Let&#39;s save it so we can come back to it later:</span></span>
<span id="cb107-69"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-69" tabindex="-1"></a><span class="fu">save</span>(p1_berry_penalty, <span class="at">file =</span> <span class="st">&quot;data/goal-plot.RData&quot;</span>)</span>
<span id="cb107-70"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-70" tabindex="-1"></a></span>
<span id="cb107-71"><a href="the-basics-of-plotting-with-ggplot2.html#cb107-71" tabindex="-1"></a>p1_berry_penalty</span></code></pre></div>
<p><img src="03-ggplot2-basics_files/figure-html/berry-penalty-plots-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can see that the 2 most important attributes for driving liking are the same across all 4 berries, but that the highest penalty is different across them.</p>
</div>
</div>
<div id="some-further-reading" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Some further reading<a href="the-basics-of-plotting-with-ggplot2.html#some-further-reading" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This has been a lightning tour of <code>ggplot2</code> as preparatory material; it barely scratches the surface. We’re going to dig into some further tools that you can use for common sensory visualizations, but we’ve learned all of these tricks from the following resources (as well as a lot of work on Stack Overflow/Exchange):</p>
<ol style="list-style-type: decimal">
<li>Kieran Healy’s “<a href="https://socviz.co/index.html#preface">Data Visualization: a Practical Introduction</a>”.</li>
<li>The plotting section of <a href="https://r4ds.had.co.nz/data-visualisation.html">R for Data Science</a>.</li>
<li>Hadley Wickham’s core reference textbook on <a href="https://ggplot2-book.org/">ggplot2</a>.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="importing-and-wrangling-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-ggplot-with-other-packages.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
