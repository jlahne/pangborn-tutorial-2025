<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 The basics of plotting with ggplot2 | Publication-quality data visualizations using the R tidyverse</title>
  <meta name="description" content="2 The basics of plotting with ggplot2 | Publication-quality data visualizations using the R tidyverse" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="2 The basics of plotting with ggplot2 | Publication-quality data visualizations using the R tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="jlahne/pangborn-tutorial-2025" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 The basics of plotting with ggplot2 | Publication-quality data visualizations using the R tidyverse" />
  
  
  

<meta name="author" content="Jacob Lahne" />
<meta name="author" content="Kyle Hamilton" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="importing-and-wrangling-data.html"/>
<link rel="next" href="fine-tuning-publication-quality-ggplots.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction and welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#introductions"><i class="fa fa-check"></i>Introductions</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#kyle-hamilton-phd"><i class="fa fa-check"></i>Kyle Hamilton, PhD</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#jacob-lahne-phd"><i class="fa fa-check"></i>Jacob Lahne, PhD</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#elizabeth-clark-phd"><i class="fa fa-check"></i>Elizabeth Clark, PhD</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#todays-agenda"><i class="fa fa-check"></i>Today’s agenda</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-were-going-to-run"><i class="fa fa-check"></i>How we’re going to run</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#recommended-approach-for-livecoding"><i class="fa fa-check"></i>Recommended approach for livecoding</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dealing-with-errors"><i class="fa fa-check"></i>Dealing with errors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#psa-not-knowing-is-normal"><i class="fa fa-check"></i>PSA: not-knowing is normal!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i>Getting Help</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html"><i class="fa fa-check"></i><b>1</b> Importing and wrangling data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#motivation-exploring-berry-and-cider-cataliking-data"><i class="fa fa-check"></i><b>1.1</b> Motivation: exploring berry and cider CATA/liking data</a></li>
<li class="chapter" data-level="1.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#getting-data-into-r"><i class="fa fa-check"></i><b>1.2</b> Getting data into <code>R</code></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#where-the-data-live"><i class="fa fa-check"></i><b>1.2.1</b> Where the data live</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#the-destination"><i class="fa fa-check"></i><b>1.3</b> The destination</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#cider"><i class="fa fa-check"></i><b>1.3.1</b> Cider</a></li>
<li class="chapter" data-level="1.3.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#berries"><i class="fa fa-check"></i><b>1.3.2</b> Berries</a></li>
<li class="chapter" data-level="1.3.3" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#pubquality"><i class="fa fa-check"></i><b>1.3.3</b> “Publication quality”</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#saving-your-data"><i class="fa fa-check"></i><b>1.4</b> Saving your data</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#a-note-on-replicability"><i class="fa fa-check"></i><b>1.4.1</b> A note on replicability</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#wrap-up"><i class="fa fa-check"></i><b>1.5</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>2</b> The basics of plotting with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#your-first-ggplot"><i class="fa fa-check"></i><b>2.1</b> Your first <code>ggplot()</code></a></li>
<li class="chapter" data-level="2.2" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#the-aes-function-and-mapping-argument"><i class="fa fa-check"></i><b>2.2</b> The <code>aes()</code> function and <code>mapping =</code> argument</a></li>
<li class="chapter" data-level="2.3" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#adding-layers-with-geom_-functions"><i class="fa fa-check"></i><b>2.3</b> Adding layers with <code>geom_*()</code> functions</a></li>
<li class="chapter" data-level="2.4" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#arguments-inside-and-outside-of-aes"><i class="fa fa-check"></i><b>2.4</b> Arguments inside and outside of <code>aes()</code></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#using-theme_-to-change-visual-options-quickly"><i class="fa fa-check"></i><b>2.4.1</b> Using <code>theme_*()</code> to change visual options quickly</a></li>
<li class="chapter" data-level="2.4.2" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#changing-aesthetic-elements-with-scale_-functions"><i class="fa fa-check"></i><b>2.4.2</b> Changing aesthetic elements with <code>scale_*()</code> functions</a></li>
<li class="chapter" data-level="2.4.3" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#finally-facet_"><i class="fa fa-check"></i><b>2.4.3</b> Finally, <code>facet_*()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#some-further-reading"><i class="fa fa-check"></i><b>2.5</b> Some further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html"><i class="fa fa-check"></i><b>3</b> Fine-Tuning Publication-Quality ggplots</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#exporting-and-saving-plots"><i class="fa fa-check"></i><b>3.1</b> Exporting and Saving Plots</a>
<ul>
<li class="chapter" data-level="" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#ggsave"><i class="fa fa-check"></i>Exporting Images with <code>ggsave()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#fine-tuning-bar-plots-facets-with-different-categorical-variables"><i class="fa fa-check"></i><b>3.2</b> Fine-tuning bar plots &amp; facets with different categorical variables</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#horizontal-text-with-coord_flip"><i class="fa fa-check"></i><b>3.2.1</b> Horizontal text with coord_flip()</a></li>
<li class="chapter" data-level="3.2.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#reorderwithin"><i class="fa fa-check"></i><b>3.2.2</b> Ordered Categorical Variables</a></li>
<li class="chapter" data-level="3.2.3" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#making-labels-look-okay-powerful-text-manipulation-with-stringr"><i class="fa fa-check"></i><b>3.2.3</b> Making labels look okay: Powerful text manipulation with <code>stringr</code></a></li>
<li class="chapter" data-level="3.2.4" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#removing-plot-elements"><i class="fa fa-check"></i><b>3.2.4</b> Removing Plot Elements</a></li>
<li class="chapter" data-level="3.2.5" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#putting-it-all-together"><i class="fa fa-check"></i><b>3.2.5</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#fine-tuning-biplots-with-different-types-of-variables"><i class="fa fa-check"></i><b>3.3</b> Fine-tuning biplots with different types of variables</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#axis-and-plot-labels-based-on-variables"><i class="fa fa-check"></i><b>3.3.1</b> Axis and plot labels based on variables</a></li>
<li class="chapter" data-level="3.3.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#setting-up-the-cartesian-plane"><i class="fa fa-check"></i><b>3.3.2</b> Setting up the Cartesian plane</a></li>
<li class="chapter" data-level="3.3.3" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#using-only-part-of-the-dataset-for-each-geom"><i class="fa fa-check"></i><b>3.3.3</b> Using only part of the dataset for each geom</a></li>
<li class="chapter" data-level="3.3.4" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#tweaking-legends"><i class="fa fa-check"></i><b>3.3.4</b> Tweaking legends</a></li>
<li class="chapter" data-level="3.3.5" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#aesthetics-that-cant-use-scale_-functions"><i class="fa fa-check"></i><b>3.3.5</b> Aesthetics that can’t use scale_*() functions</a></li>
<li class="chapter" data-level="3.3.6" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#putting-it-all-together-1"><i class="fa fa-check"></i><b>3.3.6</b> Putting it all together</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html"><i class="fa fa-check"></i><b>4</b> Wrap-up and further resources</a>
<ul>
<li class="chapter" data-level="4.1" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#getting-help-1"><i class="fa fa-check"></i><b>4.1</b> Getting help</a></li>
<li class="chapter" data-level="4.2" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#further-readingresources"><i class="fa fa-check"></i><b>4.2</b> Further reading/resources</a></li>
<li class="chapter" data-level="4.3" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#questionscomments"><i class="fa fa-check"></i><b>4.3</b> Questions/Comments</a></li>
<li class="chapter" data-level="4.4" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#references"><i class="fa fa-check"></i><b>4.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#using-ggplot2-with-other-packages"><i class="fa fa-check"></i>Using ggplot2 with other packages</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#new-theme_s-and-scale_s"><i class="fa fa-check"></i>New <code>theme_*()</code>s and <code>scale_*()</code>s</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#finding-new-packages"><i class="fa fa-check"></i>Finding New Packages</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#ggextend"><i class="fa fa-check"></i>Modifying <code>ggplot()</code>s made by other packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#combining-plots"><i class="fa fa-check"></i>Combining Plots</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#ggformat"><i class="fa fa-check"></i>Image File Types, Sizes, and Resolutions</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#what-image-format"><i class="fa fa-check"></i>What image format?</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#simpler-sizing-vector-images"><i class="fa fa-check"></i>Simpler Sizing: Vector Images</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#raster-image-resolutions"><i class="fa fa-check"></i>Raster Image Resolutions</a></li>
<li class="chapter" data-level="4.4.1" data-path="appendix.html"><a href="appendix.html#other-image-export-options"><i class="fa fa-check"></i><b>4.4.1</b> Other Image Export Options</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#factororder"><i class="fa fa-check"></i>Specifying Ordinal Variables as Factors</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#regex"><i class="fa fa-check"></i>Regular Expressions</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Publication-quality data visualizations using the R tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-basics-of-plotting-with-ggplot2" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> The basics of plotting with <code>ggplot2</code><a href="the-basics-of-plotting-with-ggplot2.html#the-basics-of-plotting-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Base <code>R</code> includes extremely powerful utilities for data visualization, but most modern applications make use of the <code>{tidyverse}</code> package <code>{ggplot2}</code>.</p>
<p>A quick word about base <code>R</code> plotting–I don’t mean to declare that you can’t use base <code>R</code> plotting for your projects at all, and I have published several papers using base <code>R</code> plots. Particularly as you are using <code>R</code> for your own data exploration (not meant for sharing outside your team, say), base utilities like <code>plot()</code> will be very useful for quick insight.</p>
<p><code>ggplot2</code> provides a standardized, programmatic interface for data visualization, in contrast to the piecemeal approach common to base <code>R</code> graphics plotting. This means that, while the syntax itself can be challenging to learn, syntax for different tasks is linked by a common vocabulary, and differs in logical and predictable ways.</p>
<p>Together with other <code>{tidyverse}</code> principles (like <code>select()</code> and <code>filter()</code> approaches), <code>ggplot2</code> makes it easy to make publication-quality visualizations with relative ease.</p>
<p>In general, <code>ggplot2</code> works best with data in “long” or “tidy” format, such as that resulting from the output of <code>pivot_longer()</code>.</p>
<p>The schematic elements of a ggplot are as follows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb15-1" tabindex="-1"></a><span class="co"># The ggplot() function creates your plotting environment.  We usually save it to a variable in R so that we can use the plug-n-play functionality of ggplot without retyping a bunch of nonsense</span></span>
<span id="cb15-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb15-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">&lt;</span>a variable<span class="sc">&gt;</span>, <span class="at">y =</span> <span class="sc">&lt;</span>another variable<span class="sc">&gt;</span>, ...),</span>
<span id="cb15-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb15-3" tabindex="-1"></a>            <span class="at">data =</span> <span class="sc">&lt;</span>your data<span class="sc">&gt;</span>)</span>
<span id="cb15-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb15-5" tabindex="-1"></a><span class="co"># Then, you can add various ways of plotting data to make different visualizations.</span></span>
<span id="cb15-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb15-6" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb15-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb15-7" tabindex="-1"></a>  geom_<span class="sc">&lt;</span>your chosen way of plotting<span class="sc">&gt;</span>(...) <span class="sc">+</span></span>
<span id="cb15-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb15-8" tabindex="-1"></a>  theme_<span class="sc">&lt;</span>your chosen theme<span class="sc">&gt;</span> <span class="sc">+</span></span>
<span id="cb15-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb15-9" tabindex="-1"></a>  ...</span></code></pre></div>
<p>In graphical form, the following diagram (<a href="https://vt-hydroinformatics.github.io/Plotting.html#our-first-ggplot">from VT Professor JP Gannon</a>) gives an intuition of what is happening:</p>
<div class="float">
<img src="img/GGplot%20syntax.png" alt="Basic ggplot mappings. Color boxes indicate where the elements go in the function and in the plot." />
<div class="figcaption">Basic ggplot mappings. Color boxes indicate where the elements go in the function and in the plot.</div>
</div>
<div id="your-first-ggplot" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Your first <code>ggplot()</code><a href="the-basics-of-plotting-with-ggplot2.html#your-first-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our cider data is already relatively tidy and is much easier to visually inspect, so we will be primarily using it in this section.</p>
<p>Let’s begin by making an example <code>ggplot()</code> to demonstrate how it works. We will focus on the cider CA coordinates so that we can build up a somewhat meaningful plot.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb16-1" tabindex="-1"></a><span class="co"># We start with our data and pipe it into ggplot</span></span>
<span id="cb16-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb16-2" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb16-3" tabindex="-1"></a>  <span class="co"># Here we set up the base plot</span></span>
<span id="cb16-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb16-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb16-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb16-5" tabindex="-1"></a>   <span class="co"># Here we tell our base plot to add points</span></span>
<span id="cb16-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb16-6" tabindex="-1"></a>  <span class="fu">geom_point</span>()                          </span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/a%20first%20ggplot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This doesn’t look all that impressive–partly because the data being plotted itself isn’t sensible without other context that exists in the data frame, and partly because we haven’t made many changes. But before we start looking into that, let’s break down the parts of this command.</p>
</div>
<div id="the-aes-function-and-mapping-argument" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> The <code>aes()</code> function and <code>mapping =</code> argument<a href="the-basics-of-plotting-with-ggplot2.html#the-aes-function-and-mapping-argument" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>ggplot()</code> function takes two arguments that are essential, as well as some others you’ll rarely use. The first, <code>data =</code>, is straightforward, and you’ll usually be passing data to the function at the end of some pipeline using <code>%&gt;%</code></p>
<p>The second, <code>mapping =</code>, is less clear. This argument requires the <code>aes()</code> function, which can be read as the “aesthetic” function. The way that this function works is quite complex, and really not worth digging into here, but I understand it in my head as <strong>telling <code>ggplot()</code> what part of my data is going to connect to what part of the plot</strong>. So, if we write <code>aes(x = `Dim 1`)</code>, we can read this in our heads as “the values of x will be mapped from the ‘Dim 1’ column”.</p>
<blockquote>
<p>NB: The use of the <code>`</code> character in <code>`Dim 1`</code> is because the name is technically “non-syntactic”: it has a space in it. <code>R</code> allows us to save objects with names that violate the rules–containing whitespace (<code></code>), starting with a number character, or including characters like <code>(</code>, <code>)</code>, <code>$</code>, etc–by using the <code>`</code> operators. The <code>{tidyverse}</code> functions do this automatically.</p>
</blockquote>
<p>This sentence tells us the other important thing about <code>ggplot()</code> and the <code>aes()</code> mappings: <strong>mapped variables each have to be in their own column</strong>. This is another reason that <code>ggplot()</code> requires tidy data.</p>
</div>
<div id="adding-layers-with-geom_-functions" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Adding layers with <code>geom_*()</code> functions<a href="the-basics-of-plotting-with-ggplot2.html#adding-layers-with-geom_-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the above example, we added (literally, using <code>+</code>) a function called <code>geom_point()</code> to the base <code>ggplot()</code> call. This is functionally a “layer” of our plot, that tells <code>ggplot2</code> how to actually visualize the elements specified in the <code>aes()</code> function–in the case of <code>geom_point()</code>, we create a point for each row’s combination of <code>x = `Dim 1`</code> and <code>y = `Dim 2`</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb17-1" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb17-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## # A tibble: 28 × 2
##    `Dim 1` `Dim 2`
##      &lt;dbl&gt;   &lt;dbl&gt;
##  1 -0.309   0.0232
##  2 -0.331   0.0449
##  3  0.0151 -0.165 
##  4  0.192  -0.193 
##  5  0.225   0.137 
##  6  0.201   0.147 
##  7 -0.303   0.0826
##  8  0.0514 -0.111 
##  9  0.280   0.0580
## 10  0.0907 -0.0946
## # ℹ 18 more rows</code></pre>
<p>There are many <code>geom_*()</code> functions in <code>{ggplot2}</code>, and many others defined in accessory packages. These are the heart of visualizations. We can swap them out to get different results:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb19-1" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb19-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb19-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb19-3" tabindex="-1"></a>  <span class="co"># connecting our points with a line makes even less sense</span></span>
<span id="cb19-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb19-4" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/switching%20geom%20switches%20the%20way%20the%20data%20map-1.png" width="672" style="display: block; margin: auto;" />
The default <code>geom_line()</code> behavior is to connect points ordered by the column that is assigned to <code>x =</code> in the <code>aes()</code> function.</p>
<p>We can also combine layers, as the term “layer” implies:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb20-1" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb20-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb20-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb20-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb20-4" tabindex="-1"></a>  <span class="co"># add a layer with the names of the points</span></span>
<span id="cb20-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb20-5" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> name))</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/geoms%20are%20layers%20in%20a%20plot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note that we don’t need to tell <em>either</em> <code>geom_point()</code> or <code>geom_text()</code> what <code>x</code> and <code>y</code> are–they “inherit” them from the <code>ggplot()</code> function to which they are added (<code>+</code>), which defines the plot itself. But we did need to give a <em>new</em> mapping–<code>label = name</code>–to the <code>geom_text()</code> layer, which tells it which column to get the labels for each point.</p>
<p>What other arguments can be set to aesthetics? Well, we can set other visual properties like <strong>color</strong>, <strong>size</strong>, <strong>transparency</strong> (called <code>alpha</code>), and so on. Let’s go ahead and color the different points and labels by whether they are ciders or CATA descriptors–whether they are rows or columns in the original contingency table.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb21-1" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb21-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>, <span class="at">color =</span> type)) <span class="sc">+</span> </span>
<span id="cb21-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb21-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb21-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> name))</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/here%20are%20some%20other%20parts%20of%20the%20plot%20we%20can%20control%20with%20data-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice again that we don’t have to specify our color inside each label–because we define this “aesthetic” at the level of the plot in the <code>ggplot()</code> function all layers that can use it will “inherit” it.</p>
<p>If we want to only color a single layer, we have a couple options. The simplest is simply to define the mapping only at the layer level, not the plot level.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb22-1" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb22-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb22-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb22-3" tabindex="-1"></a>  <span class="co"># we will only color the points, not the text</span></span>
<span id="cb22-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb22-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb22-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb22-5" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> name))</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/color%20only%20one%20layer-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="arguments-inside-and-outside-of-aes" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Arguments inside and outside of <code>aes()</code><a href="the-basics-of-plotting-with-ggplot2.html#arguments-inside-and-outside-of-aes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the above plots, we are obviously unhappy with the position of the text in regards to the points: we are overplotting! What if we wanted to move our text so that it’s not centered on the <span class="math inline">\((x,y)\)</span> point? (We will see a better way to do this automatically later.)</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb23-1" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb23-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb23-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb23-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb23-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb23-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb23-5" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="st">&quot;outward&quot;</span>,</span>
<span id="cb23-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb23-6" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>)</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here we set two aesthetics that <em>could</em> be in the <code>aes()</code> function and tied to data, but that we want to only set to a single value: we want all of our text to be <code>"darkblue"</code> (sure, why not?) and we use the <code>hjust = "outward"</code> text alignment option to push our text away from the center of the plot and thus not to overplot our points.</p>
<p>Here I will also note that manual text adjustment is usually not the best approach with text-heavy scatterplots such as are common in sensory science biplots. We will usually prefer to use an automatic approach for adjusting text position from the <code>{ggrepel}</code> package. We can either load <code>{ggrepel}</code> directly using <code>library(ggrepel)</code> or we can use the <code>::</code> syntax to access an installed function without loading the entire namespace.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb24-1" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb24-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb24-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb24-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb24-4" tabindex="-1"></a>  <span class="co"># here we opt for not loading the package</span></span>
<span id="cb24-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb24-5" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb24-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb24-6" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb24-7" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>))</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/showing%20ggrepel-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="using-theme_-to-change-visual-options-quickly" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Using <code>theme_*()</code> to change visual options quickly<a href="the-basics-of-plotting-with-ggplot2.html#using-theme_-to-change-visual-options-quickly" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the last several plots, notice that we are using the default (and to my mind unattractive) grey background of <code>ggplot2</code>. If this tutorial had a single goal, it would be to eliminate this theme from published papers. It looks <em>bad</em> (and tends to reduce contrast).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb25-1" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb25-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb25-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb25-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb25-4" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb25-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb25-5" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb25-6" tabindex="-1"></a>  <span class="co"># here we switch to a black and white theme</span></span>
<span id="cb25-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb25-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/adding%20a%20different%20theme-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can easily get rid of the grey by adding a <code>theme_bw()</code> call to the list of commands. <code>{ggplot2}</code> includes a number of default <code>theme_*()</code> functions, and you can get many more through other <code>R</code> packages. They can have subtle to dramatic effects:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb26-1" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb26-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb26-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb26-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb26-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb26-4" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb26-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb26-5" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb26-6" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/using%20the%20theme%20functions-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The <code>theme_*()</code> functions are complete sets of plot background options. You can edit every last element of the plot’s theme using the base <code>theme()</code> function, which is powerful but a little bit tricky to use.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb27-1" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb27-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb27-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb27-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb27-4" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb27-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb27-5" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb27-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb27-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb27-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb27-7" tabindex="-1"></a>  <span class="co"># we use theme() to remove grid lines and move the legend, for example</span></span>
<span id="cb27-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb27-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb27-9" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/using%20theme-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can see a nearly-full list of the arguments to <code>ggplot2::theme()</code> in the theme help files (<code>?theme</code>), unlike with <code>{ggplot2}</code> aesthetics and the <code>geom_*()</code> help files.</p>
<p>Many calls to <code>theme()</code> involve <code>element_*()</code> functions. When we remove elements, for example, we use <code>element_blank()</code> (not, for example, <code>NA</code> or <code>NULL</code> as we typically would in other parts of <code>R</code>).</p>
<p>When we want to change how our text is formatted (not the values, but the formatting), we use <code>element_text()</code> calls.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb28-1" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb28-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb28-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb28-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb28-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb28-4" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb28-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb28-5" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb28-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb28-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb28-7" tabindex="-1"></a>  <span class="co"># let&#39;s make the axis titles bold and the labels serif-font</span></span>
<span id="cb28-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb28-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb28-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb28-9" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;serif&quot;</span>))</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/element_text-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Finally, we can set default themes for a particular script using the <code>theme_set()</code> function. We can also use this to set custom defaults:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb29-1" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb29-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb29-2" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb29-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb29-3" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb29-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb29-4" tabindex="-1"></a>)</span>
<span id="cb29-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb29-5" tabindex="-1"></a></span>
<span id="cb29-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb29-6" tabindex="-1"></a>ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb29-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb29-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb29-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb29-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb29-9" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb29-10"><a href="the-basics-of-plotting-with-ggplot2.html#cb29-10" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>)</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/setting%20the%20default%20theme%20then%20making%20a%20ggplot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>All plots from here on in the script will <em>default</em> to the <code>theme_bw()</code> theme, with the “minor” grid lines removed for a cleaner grid look.</p>
</div>
<div id="changing-aesthetic-elements-with-scale_-functions" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Changing aesthetic elements with <code>scale_*()</code> functions<a href="the-basics-of-plotting-with-ggplot2.html#changing-aesthetic-elements-with-scale_-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, say we didn’t like the default color set for the points.</p>
<p>How can we manipulate the colors that are plotted? The <strong>way in which</strong> mapped, aesthetic variables are assigned to visual elements is controlled by the <code>scale_*()</code> functions.</p>
<p>In my experience, the most frequently encountered scales are those for color: either <code>scale_fill_*()</code> for solid objects (like the bars in a histogram) or <code>scale_color_*()</code> for lines and points (like the outlines of the histogram bars, or the points and letters in our scatterplots so far).</p>
<p>Scale functions work by telling <code>ggplot()</code> <em>how</em> to map aesthetic variables to visual elements. You may have noticed that I added a <code>scale_color_manual()</code> function to the end of several plots above. This function lets me manually specify the colors that are assigned to each colored element.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb30-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> </span>
<span id="cb30-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb30-2" tabindex="-1"></a>  ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb30-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>, <span class="at">color =</span> type)) <span class="sc">+</span> </span>
<span id="cb30-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb30-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb30-5" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> name), </span>
<span id="cb30-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb30-6" tabindex="-1"></a>                           <span class="co"># this command stops this layer from being added to</span></span>
<span id="cb30-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb30-7" tabindex="-1"></a>                           <span class="co"># the legend, to make it look cleaner</span></span>
<span id="cb30-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb30-8" tabindex="-1"></a>                           <span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb30-9" tabindex="-1"></a></span>
<span id="cb30-10"><a href="the-basics-of-plotting-with-ggplot2.html#cb30-10" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/ggplots%20are%20R%20objects-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can take a saved plot (like <code>p</code>) and use scales to change how it is visualized.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb31-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>()</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/we%20can%20modify%20stored%20plots%20after%20the%20fact-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><code>ggplot2</code> has a broad range of built-in options for scales, but there are many others available in add-on packages that build on top of it. The <code>scale_*_viridis_*()</code> functions use a package called <code>{viridis}</code> that provides color-blind safe colors for both continuous (gradient) and categorical (discrete) mappings, <em>but</em> their defaults (using light colors like yellow on one end of the scale) will inevitably have contrast issues with the plot background for <code>geom_text()</code> and <code>geom_point()</code>, making them hard to see for anyone!</p>
<p>As we saw above, you can also build your own scales using the <code>scale_*_manual()</code> functions, in which you give a vector of the same length as your mapped aesthetic variable in order to set up the visual assignment. That sounds jargon-y, so here is an example:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb32-1" tabindex="-1"></a><span class="co"># We&#39;ll pick 14 random colors from the colors R knows about</span></span>
<span id="cb32-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb32-3" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb32-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb32-4" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;wheat&quot;</span>, <span class="st">&quot;darkviolet&quot;</span>))</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/another%20example%20of%20posthoc%20plot%20modification-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="finally-facet_" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Finally, <code>facet_*()</code><a href="the-basics-of-plotting-with-ggplot2.html#finally-facet_" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far we’ve seen how to visualize the overall configuration of our ciders by their CATA attributes using a Correspondence Analysis. These results are, of course, based on an underlying contingency table:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb33-1" tabindex="-1"></a>cider_contingency</span></code></pre></div>
<pre><code>##                   Fresh_Apples Fermented Herbal Dry Spice Fruity Smooth Alcohol
## 1911 Est. Chilled           29        12      4  16    10     24     15      19
## 1911 Est. RT                27        17      7  15     5     25     18      13
## Buskey Chilled              19        22      8  22     9     15     15      19
## Buskey RT                   11        18     10  21    12     14     14      21
## Eden Chilled                16        14     13  20     9     13      9      17
## Eden RT                     17        18     10  17     7     16      7      21
##                   Light Sweet Woody Berries Sour Funky FullBodied Metallic
## 1911 Est. Chilled    19    16     2       4   20     1          4        5
## 1911 Est. RT         17    25     6       8   23     2          8        4
## Buskey Chilled       20    19     5       4   14    10          5        4
## Buskey RT            16    18     7       2   14    10          8        2
## Eden Chilled         11    14     8       2   24    12          5        9
## Eden RT              13    15    12       4   23    12          5        7
##                   Floral Candy Bitter Vomit Earthy Synthetic
## 1911 Est. Chilled      8     6     10     2      3         3
## 1911 Est. RT          10     6      7     1      2         3
## Buskey Chilled        13     1     12     1      5         3
## Buskey RT              9     0     13     5      9         4
## Eden Chilled          11     3     13     5      9         7
## Eden RT               11     1     13     3      6        10</code></pre>
<p>A natural visualization to quickly assess CATA results is of course a bar plot.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb35-1" tabindex="-1"></a>cider_contingency <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb35-2" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;sample&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb35-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>sample) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb35-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> value, <span class="at">fill =</span> sample)) <span class="sc">+</span> </span>
<span id="cb35-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb35-5" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb35-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb35-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb35-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb35-7" tabindex="-1"></a>  <span class="co"># coord_*() functions affect how the axes are plotted;</span></span>
<span id="cb35-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb35-8" tabindex="-1"></a>  <span class="co"># coord_flip() switches the x- and y-axes</span></span>
<span id="cb35-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb35-9" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This is obviously not ideal for visualization:</p>
<ol style="list-style-type: decimal">
<li>It is hard to see the bars.</li>
<li>CA plots are driven by ratios, so it would be good to see differences based on rates of endorsement for CATA per-attribute, not overall (common attributes swamp uncommon attributes).</li>
</ol>
<p>The last powerful tool I want to show off is the ability of <code>ggplot2</code> to make what <a href="https://socviz.co/groupfacettx.html#facet-to-make-small-multiples">Edward Tufte called “small multiples”</a>: breaking out the data into multiple, identical plots by some categorical classifier in order to show trends more effectively.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb36-1" tabindex="-1"></a>cider_contingency <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb36-2" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;sample&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb36-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>sample) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb36-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb36-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb36-5" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> sample)) <span class="sc">+</span></span>
<span id="cb36-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb36-6" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> wesanderson<span class="sc">::</span>wes_palettes<span class="sc">$</span>AsteroidCity2) <span class="sc">+</span> </span>
<span id="cb36-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb36-7" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb36-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb36-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb36-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb36-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb36-10"><a href="the-basics-of-plotting-with-ggplot2.html#cb36-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/cider-facets-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can see that overall for the most frequently used attributes, the serving temperature doesn’t matter (and for the most part there is some reassuring consistency in the use of terms to describe each cider at different temperatures).</p>
<p>But in the previous part of this workshop, we showed much more complex plots for our berry data, which showed the same plot broken up by a classifying variable: this is called “faceting”. Let’s return from our cider data to our berry data in order to finally complete the workflow I showed in the beginning of the workshop.</p>
<p>Now we are prepared to walk through the entire workflow:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-1" tabindex="-1"></a>p1_berry_penalty <span class="ot">&lt;-</span> </span>
<span id="cb37-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-2" tabindex="-1"></a>  </span>
<span id="cb37-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-3" tabindex="-1"></a>  berry_penalty_analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-4" tabindex="-1"></a>  </span>
<span id="cb37-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-5" tabindex="-1"></a>  <span class="co"># We are using a function from tidytext that makes faceting the final figure</span></span>
<span id="cb37-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-6" tabindex="-1"></a>  <span class="co"># easier: reorder_within() makes a set of factors able to be ordered</span></span>
<span id="cb37-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-7" tabindex="-1"></a>  <span class="co"># differently within another variable.  In this case, we have different</span></span>
<span id="cb37-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-8" tabindex="-1"></a>  <span class="co"># attributes and different penalties within each berry by design</span></span>
<span id="cb37-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-9" tabindex="-1"></a>  </span>
<span id="cb37-10"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cata_variable_clean =</span> tidytext<span class="sc">::</span><span class="fu">reorder_within</span>(<span class="at">x =</span> cata_variable_clean,</span>
<span id="cb37-11"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-11" tabindex="-1"></a>                                                        <span class="at">by =</span> penalty_lift,</span>
<span id="cb37-12"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-12" tabindex="-1"></a>                                                        <span class="at">within =</span> berry)) <span class="sc">%&gt;%</span></span>
<span id="cb37-13"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-13" tabindex="-1"></a>  </span>
<span id="cb37-14"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-14" tabindex="-1"></a>  <span class="co">#And finally we plot!</span></span>
<span id="cb37-15"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-15" tabindex="-1"></a>  </span>
<span id="cb37-16"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cata_variable_clean, <span class="at">y =</span> penalty_lift)) <span class="sc">+</span></span>
<span id="cb37-17"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-17" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> penalty_lift), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb37-18"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-18" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>berry, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb37-19"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-19" tabindex="-1"></a>  </span>
<span id="cb37-20"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-20" tabindex="-1"></a>  <span class="co"># To take advantage of our newly reordered factors, we also need to use the</span></span>
<span id="cb37-21"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-21" tabindex="-1"></a>  <span class="co"># matching tidytext::scale_x_reordered() function</span></span>
<span id="cb37-22"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-22" tabindex="-1"></a>  </span>
<span id="cb37-23"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-23" tabindex="-1"></a>  tidytext<span class="sc">::</span><span class="fu">scale_x_reordered</span>() <span class="sc">+</span> </span>
<span id="cb37-24"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-24" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb37-25"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-25" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb37-26"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-26" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;tan&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span> </span>
<span id="cb37-27"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb37-28"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-28" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Penalty / Lift Analysis&quot;</span>,</span>
<span id="cb37-29"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-29" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;displays the mean difference (within berries) for when a CATA variable is checked&quot;</span>)</span>
<span id="cb37-30"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-30" tabindex="-1"></a></span>
<span id="cb37-31"><a href="the-basics-of-plotting-with-ggplot2.html#cb37-31" tabindex="-1"></a>p1_berry_penalty</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/berry-final-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can see that the 2 most important attributes for driving liking are the same across all 4 berries, but that the highest penalty is different across them.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-1" tabindex="-1"></a><span class="co"># First, we have some string-wrangling to do so that our various labels are</span></span>
<span id="cb38-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-2" tabindex="-1"></a><span class="co"># more descriptive and seem like a person wrote them, rather than a computer.</span></span>
<span id="cb38-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-4" tabindex="-1"></a>nice_cider_labels <span class="ot">&lt;-</span></span>
<span id="cb38-5"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">str_c</span>(<span class="st">&quot;Dimension 1, &quot;</span>, <span class="fu">round</span>(ca_cider<span class="sc">$</span>eig[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dv">1</span>), <span class="st">&quot;% of inertia&quot;</span>),</span>
<span id="cb38-6"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">str_c</span>(<span class="st">&quot;Dimension 2, &quot;</span>, <span class="fu">round</span>(ca_cider<span class="sc">$</span>eig[<span class="dv">2</span>, <span class="dv">2</span>], <span class="dv">1</span>), <span class="st">&quot;% of inertia&quot;</span>),</span>
<span id="cb38-7"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Correspondence Analysis biplot (symmetric)&quot;</span>,</span>
<span id="cb38-8"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-8" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Effect of cider serving temperature on consumer sensory perception&quot;</span>)</span>
<span id="cb38-9"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-9" tabindex="-1"></a></span>
<span id="cb38-10"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-10" tabindex="-1"></a>p2_ca_cider_cata <span class="ot">&lt;-</span> </span>
<span id="cb38-11"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-11" tabindex="-1"></a>  ca_cider_coords <span class="sc">%&gt;%</span></span>
<span id="cb38-12"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-12" tabindex="-1"></a>  </span>
<span id="cb38-13"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-13" tabindex="-1"></a>  <span class="co"># A few specific aesthetics don&#39;t have scale_*() functions and require that</span></span>
<span id="cb38-14"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-14" tabindex="-1"></a>  <span class="co"># you make a column with the exact names of the &quot;value&quot;. Fontface is one of them.</span></span>
<span id="cb38-15"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-15" tabindex="-1"></a>  </span>
<span id="cb38-16"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">font =</span> <span class="fu">if_else</span>(type <span class="sc">==</span> <span class="st">&quot;row&quot;</span>, <span class="st">&quot;plain&quot;</span>, <span class="st">&quot;italic&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-17"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-17" tabindex="-1"></a>  </span>
<span id="cb38-18"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-18" tabindex="-1"></a>  <span class="co"># And now we plot!</span></span>
<span id="cb38-19"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-19" tabindex="-1"></a>  </span>
<span id="cb38-20"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-20" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb38-21"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-21" tabindex="-1"></a>  </span>
<span id="cb38-22"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-22" tabindex="-1"></a>  <span class="co"># We can use geoms to make darker lines at the origin of each axis.</span></span>
<span id="cb38-23"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-23" tabindex="-1"></a>  <span class="co"># This goes first so that all of our data points are drawn on top.</span></span>
<span id="cb38-24"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-24" tabindex="-1"></a>  </span>
<span id="cb38-25"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-25" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-26"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-26" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-27"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-27" tabindex="-1"></a>  </span>
<span id="cb38-28"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-28" tabindex="-1"></a>  <span class="co"># We want to represent our samples with geom_point and our attributes</span></span>
<span id="cb38-29"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-29" tabindex="-1"></a>  <span class="co"># with geom_text, so we need to do some creative filtering.</span></span>
<span id="cb38-30"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-30" tabindex="-1"></a>  </span>
<span id="cb38-31"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-31" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> type, <span class="at">shape =</span> Temperature),</span>
<span id="cb38-32"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-32" tabindex="-1"></a>             <span class="at">data =</span> ca_cider_coords <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;row&quot;</span>),</span>
<span id="cb38-33"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-33" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-34"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-34" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">color =</span> type, <span class="at">fontface =</span> font),</span>
<span id="cb38-35"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-35" tabindex="-1"></a>                           <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-36"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-36" tabindex="-1"></a>  </span>
<span id="cb38-37"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-37" tabindex="-1"></a>  <span class="co"># and now we do our fine-tuning.</span></span>
<span id="cb38-38"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-38" tabindex="-1"></a>  </span>
<span id="cb38-39"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-39" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span> </span>
<span id="cb38-40"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-40" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb38-41"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-41" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-42"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-42" tabindex="-1"></a>  nice_cider_labels <span class="sc">+</span> </span>
<span id="cb38-43"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-43" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>)) <span class="sc">+</span></span>
<span id="cb38-44"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-44" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb38-45"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-45" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape =</span> <span class="fu">guide_legend</span>(),</span>
<span id="cb38-46"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-46" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb38-47"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-47" tabindex="-1"></a></span>
<span id="cb38-48"><a href="the-basics-of-plotting-with-ggplot2.html#cb38-48" tabindex="-1"></a>p2_ca_cider_cata</span></code></pre></div>
<p><img src="02-ggplot2-basics_files/figure-html/cider-final-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="the-basics-of-plotting-with-ggplot2.html#cb39-1" tabindex="-1"></a><span class="co"># Let&#39;s save them so we can come back to them later:</span></span>
<span id="cb39-2"><a href="the-basics-of-plotting-with-ggplot2.html#cb39-2" tabindex="-1"></a><span class="fu">save</span>(p1_berry_penalty,</span>
<span id="cb39-3"><a href="the-basics-of-plotting-with-ggplot2.html#cb39-3" tabindex="-1"></a>     p2_ca_cider_cata,</span>
<span id="cb39-4"><a href="the-basics-of-plotting-with-ggplot2.html#cb39-4" tabindex="-1"></a>     <span class="at">file =</span> <span class="st">&quot;data/goal-plots.RData&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="some-further-reading" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Some further reading<a href="the-basics-of-plotting-with-ggplot2.html#some-further-reading" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This has been a lightning tour of <code>ggplot2</code> as preparatory material; it barely scratches the surface. We’re going to dig into some further tools that you can use for common sensory visualizations, but we’ve learned all of these tricks from the following resources (as well as a lot of work on Stack Overflow/Exchange):</p>
<ol style="list-style-type: decimal">
<li>Kieran Healy’s “<a href="https://socviz.co/index.html#preface">Data Visualization: a Practical Introduction</a>”.</li>
<li>The plotting section of <a href="https://r4ds.had.co.nz/data-visualisation.html">R for Data Science</a>.</li>
<li>Hadley Wickham’s core reference textbook on <a href="https://ggplot2-book.org/">ggplot2</a>.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="importing-and-wrangling-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fine-tuning-publication-quality-ggplots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
