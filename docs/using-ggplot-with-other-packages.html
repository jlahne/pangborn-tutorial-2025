<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Using ggplot with Other Packages | Publication-quality data visualizations using the R tidyverse</title>
  <meta name="description" content="4 Using ggplot with Other Packages | Publication-quality data visualizations using the R tidyverse" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Using ggplot with Other Packages | Publication-quality data visualizations using the R tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="lhami/sensometrics-tutorial-2024" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Using ggplot with Other Packages | Publication-quality data visualizations using the R tidyverse" />
  
  
  

<meta name="author" content="Jacob Lahne" />
<meta name="author" content="Leah Hamilton" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-basics-of-plotting-with-ggplot2.html"/>
<link rel="next" href="fine-tuning-publication-quality-ggplots.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction and welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#introductions"><i class="fa fa-check"></i>Introductions</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#leah-hamilton-phd"><i class="fa fa-check"></i>Leah Hamilton, PhD</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#jacob-lahne-phd"><i class="fa fa-check"></i>Jacob Lahne, PhD</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#todays-agenda"><i class="fa fa-check"></i>Today’s agenda</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-were-going-to-run"><i class="fa fa-check"></i>How we’re going to run</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#recommended-approach-for-livecoding"><i class="fa fa-check"></i>Recommended approach for livecoding</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dealing-with-errors"><i class="fa fa-check"></i>Dealing with errors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#psa-not-knowing-is-normal"><i class="fa fa-check"></i>PSA: not-knowing is normal!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i>Getting Help</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> A crash course in <code>R</code> and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#r-vs-rstudio"><i class="fa fa-check"></i><b>1.1</b> <code>R</code> vs RStudio</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#what-is-r"><i class="fa fa-check"></i><b>1.1.1</b> What is <code>R</code>?</a></li>
<li class="chapter" data-level="1.1.2" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#great-why-are-we-using-rstudio-then"><i class="fa fa-check"></i><b>1.1.2</b> Great, why are we using RStudio then?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#the-parts-of-rstudio"><i class="fa fa-check"></i><b>1.2</b> The parts of RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#the-working-directory-and-why-you-should-care"><i class="fa fa-check"></i><b>1.2.1</b> The “working directory” and why you should care</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#extending-r-with-packages"><i class="fa fa-check"></i><b>1.3</b> Extending <code>R</code> with packages</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#loading-packages"><i class="fa fa-check"></i><b>1.3.1</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#making-r-do-stuff"><i class="fa fa-check"></i><b>1.4</b> Making <code>R</code> do stuff</a></li>
<li class="chapter" data-level="1.5" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#livecoding-along"><i class="fa fa-check"></i><b>1.5</b> Livecoding along</a></li>
<li class="chapter" data-level="1.6" data-path="a-crash-course-in-r-and-rstudio.html"><a href="a-crash-course-in-r-and-rstudio.html#summary-and-next-steps"><i class="fa fa-check"></i><b>1.6</b> Summary and next steps</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html"><i class="fa fa-check"></i><b>2</b> Importing and wrangling data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#motivation-exploring-berry-and-cider-cataliking-data"><i class="fa fa-check"></i><b>2.1</b> Motivation: exploring berry and cider CATA/liking data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#berries"><i class="fa fa-check"></i><b>2.1.1</b> Berries</a></li>
<li class="chapter" data-level="2.1.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#cider"><i class="fa fa-check"></i><b>2.1.2</b> Cider</a></li>
<li class="chapter" data-level="2.1.3" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#publication-quality"><i class="fa fa-check"></i><b>2.1.3</b> “Publication quality”</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#getting-data-into-r"><i class="fa fa-check"></i><b>2.2</b> Getting data into <code>R</code></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#where-the-data-live"><i class="fa fa-check"></i><b>2.2.1</b> Where the data live</a></li>
<li class="chapter" data-level="2.2.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#getting-different-kinds-of-files-into-r"><i class="fa fa-check"></i><b>2.2.2</b> Getting different kinds of files into <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#wrangling-selecting-filtering-reshaping-data"><i class="fa fa-check"></i><b>2.3</b> Wrangling (selecting, filtering, reshaping) data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#the-pipe-for-multiple-steps-in-a-workflow"><i class="fa fa-check"></i><b>2.3.1</b> The “pipe” for multiple steps in a workflow: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#subsetting-your-data"><i class="fa fa-check"></i><b>2.3.2</b> Subsetting your data</a></li>
<li class="chapter" data-level="2.3.3" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#reshaping-your-data"><i class="fa fa-check"></i><b>2.3.3</b> Reshaping your data</a></li>
<li class="chapter" data-level="2.3.4" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#some-convenience-functions"><i class="fa fa-check"></i><b>2.3.4</b> Some convenience functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#saving-your-data"><i class="fa fa-check"></i><b>2.4</b> Saving your data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#a-note-on-replicability"><i class="fa fa-check"></i><b>2.4.1</b> A note on replicability</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="importing-and-wrangling-data.html"><a href="importing-and-wrangling-data.html#wrap-up"><i class="fa fa-check"></i><b>2.5</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>3</b> The basics of plotting with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#your-first-ggplot"><i class="fa fa-check"></i><b>3.1</b> Your first <code>ggplot()</code></a></li>
<li class="chapter" data-level="3.2" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#the-aes-function-and-mapping-argument"><i class="fa fa-check"></i><b>3.2</b> The <code>aes()</code> function and <code>mapping =</code> argument</a></li>
<li class="chapter" data-level="3.3" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#adding-layers-with-geom_-functions"><i class="fa fa-check"></i><b>3.3</b> Adding layers with <code>geom_*()</code> functions</a></li>
<li class="chapter" data-level="3.4" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#arguments-inside-and-outside-of-aes"><i class="fa fa-check"></i><b>3.4</b> Arguments inside and outside of <code>aes()</code></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#using-theme_-to-change-visual-options-quickly"><i class="fa fa-check"></i><b>3.4.1</b> Using <code>theme_*()</code> to change visual options quickly</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#changing-aesthetic-elements-with-scale_-functions"><i class="fa fa-check"></i><b>3.4.2</b> Changing aesthetic elements with <code>scale_*()</code> functions</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#finally-facet_"><i class="fa fa-check"></i><b>3.4.3</b> Finally, <code>facet_*()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-basics-of-plotting-with-ggplot2.html"><a href="the-basics-of-plotting-with-ggplot2.html#some-further-reading"><i class="fa fa-check"></i><b>3.5</b> Some further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html"><i class="fa fa-check"></i><b>4</b> Using ggplot with Other Packages</a>
<ul>
<li class="chapter" data-level="4.1" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#data-for-the-rest-of-the-tutorial"><i class="fa fa-check"></i><b>4.1</b> Data for the rest of the tutorial</a></li>
<li class="chapter" data-level="4.2" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#new-geom_s-and-stat_s"><i class="fa fa-check"></i><b>4.2</b> New <code>geom_*()s</code> and <code>stat_*()</code>s</a></li>
<li class="chapter" data-level="4.3" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#new-theme_s-and-scale_s"><i class="fa fa-check"></i><b>4.3</b> New <code>theme_*()</code>s and <code>scale_*()</code>s</a></li>
<li class="chapter" data-level="4.4" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#modifying-ggplots-made-by-other-packages"><i class="fa fa-check"></i><b>4.4</b> Modifying <code>ggplot()</code>s made by other packages</a></li>
<li class="chapter" data-level="4.5" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#combining-plots"><i class="fa fa-check"></i><b>4.5</b> Combining Plots</a></li>
<li class="chapter" data-level="4.6" data-path="using-ggplot-with-other-packages.html"><a href="using-ggplot-with-other-packages.html#finding-new-packages"><i class="fa fa-check"></i><b>4.6</b> Finding New Packages</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html"><i class="fa fa-check"></i><b>5</b> Fine-Tuning Publication-Quality ggplots</a>
<ul>
<li class="chapter" data-level="5.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#exporting-and-saving-plots"><i class="fa fa-check"></i><b>5.1</b> Exporting and Saving Plots</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#what-format"><i class="fa fa-check"></i><b>5.1.1</b> What format?</a></li>
<li class="chapter" data-level="5.1.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#ggsave"><i class="fa fa-check"></i><b>5.1.2</b> Exporting Images with <code>ggsave()</code></a></li>
<li class="chapter" data-level="5.1.3" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#other-image-export-options"><i class="fa fa-check"></i><b>5.1.3</b> Other Image Export Options</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#making-text-look-okay"><i class="fa fa-check"></i><b>5.2</b> Making Text Look Okay</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#powerful-text-manipulation-with-stringr"><i class="fa fa-check"></i><b>5.2.1</b> Powerful Text Manipulation with <code>stringr</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#removing-legends-and-plot-elements"><i class="fa fa-check"></i><b>5.3</b> Removing Legends and Plot Elements</a></li>
<li class="chapter" data-level="5.4" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#ordered-categorical-variables"><i class="fa fa-check"></i><b>5.4</b> Ordered Categorical Variables</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#specifying-ordinal-variables-as-factors"><i class="fa fa-check"></i><b>5.4.1</b> Specifying Ordinal Variables as Factors</a></li>
<li class="chapter" data-level="5.4.2" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#facets-with-different-category-orders"><i class="fa fa-check"></i><b>5.4.2</b> Facets with Different Category-Orders</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="fine-tuning-publication-quality-ggplots.html"><a href="fine-tuning-publication-quality-ggplots.html#putting-it-all-together"><i class="fa fa-check"></i><b>5.5</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html"><i class="fa fa-check"></i><b>6</b> Wrap-up and further resources</a>
<ul>
<li class="chapter" data-level="6.1" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#getting-help-1"><i class="fa fa-check"></i><b>6.1</b> Getting help</a></li>
<li class="chapter" data-level="6.2" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#further-readingresources"><i class="fa fa-check"></i><b>6.2</b> Further reading/resources</a></li>
<li class="chapter" data-level="6.3" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#questionscomments"><i class="fa fa-check"></i><b>6.3</b> Questions/Comments</a></li>
<li class="chapter" data-level="6.4" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#references"><i class="fa fa-check"></i><b>6.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#ggresolution"><i class="fa fa-check"></i>Image Sizes and Raster Resolutions</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#simpler-sizing-vector-images"><i class="fa fa-check"></i>Simpler Sizing: Vector Images</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#raster-image-resolutions"><i class="fa fa-check"></i>Raster Image Resolutions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#regex"><i class="fa fa-check"></i>Regular Expressions</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Publication-quality data visualizations using the R tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="using-ggplot-with-other-packages" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Using ggplot with Other Packages<a href="using-ggplot-with-other-packages.html#using-ggplot-with-other-packages" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>As you might have noticed, we had you download more packages than just <code>ggplot2</code> for this tutorial. <code>ggplot2</code> is a framework and will help you make many standard plots, but it can’t do everything. Or, sometimes, you may not want to use it to do everything yourself.</p>
<p>Packages meant to work with <code>ggplot2</code> to more easily make specific kinds of visualizations are also called ggplot <strong>extensions</strong>. The four most common kinds of ggplot extensions are:</p>
<ol style="list-style-type: decimal">
<li>Packages that add <code>geom_*()s</code> or <code>stat_*()</code>s for new kinds of plots</li>
<li>Packages that add <code>theme_*()</code>s and <code>scale_*()</code>s for specific color or style needs</li>
<li>Packages that make <code>ggplot</code> objects, so you never write <code>ggplot()</code> yourself</li>
<li>Packages that combine multiple plots in various ways</li>
</ol>
<p>You can view many of these extensions <a href="https://exts.ggplot2.tidyverse.org/gallery/">on the tidyverse website</a> (where you’ll also see many examples that fall into multiple of these categories or don’t fit into the categories here at all).</p>
<div id="data-for-the-rest-of-the-tutorial" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Data for the rest of the tutorial<a href="using-ggplot-with-other-packages.html#data-for-the-rest-of-the-tutorial" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In order to dive into the actual visualization parts of a data analysis workflow, we’re going to skip over most of the intensive data wrangling from here on out. In addition to the existing <code>raw_berry_data</code> and <code>raw_cider_data</code> we’ve read in previously with <code>read_csv()</code>, let’s use <code>load("data/cleaned-data.RData")</code> to pull in 6 tibbles of data at various intermediate stages.</p>
<p>If you’re curious, we’ve included all of the code we used to wrangle these tibbles in the script <code>datawrangling.R</code>, but for now, let’s just load them in and use the <code>FactoMineR</code> package to get some product coordinates.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="using-ggplot-with-other-packages.html#cb108-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/cleaned-data.RData&quot;</span>)</span>
<span id="cb108-2"><a href="using-ggplot-with-other-packages.html#cb108-2" tabindex="-1"></a></span>
<span id="cb108-3"><a href="using-ggplot-with-other-packages.html#cb108-3" tabindex="-1"></a>cider_contingency <span class="sc">%&gt;%</span></span>
<span id="cb108-4"><a href="using-ggplot-with-other-packages.html#cb108-4" tabindex="-1"></a>  FactoMineR<span class="sc">::</span><span class="fu">CA</span>(<span class="at">graph =</span> <span class="cn">FALSE</span>) <span class="ot">-&gt;</span> ca_cider</span>
<span id="cb108-5"><a href="using-ggplot-with-other-packages.html#cb108-5" tabindex="-1"></a></span>
<span id="cb108-6"><a href="using-ggplot-with-other-packages.html#cb108-6" tabindex="-1"></a>berry_mfa_summary <span class="sc">%&gt;%</span></span>
<span id="cb108-7"><a href="using-ggplot-with-other-packages.html#cb108-7" tabindex="-1"></a>  FactoMineR<span class="sc">::</span><span class="fu">MFA</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="fu">sum</span>(<span class="fu">str_detect</span>(<span class="fu">colnames</span>(berry_mfa_summary), <span class="st">&quot;^cata_&quot;</span>)),</span>
<span id="cb108-8"><a href="using-ggplot-with-other-packages.html#cb108-8" tabindex="-1"></a>                            <span class="fu">sum</span>(<span class="fu">str_detect</span>(<span class="fu">colnames</span>(berry_mfa_summary), <span class="st">&quot;^liking_&quot;</span>))),</span>
<span id="cb108-9"><a href="using-ggplot-with-other-packages.html#cb108-9" tabindex="-1"></a>                  <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;f&quot;</span>,<span class="st">&quot;s&quot;</span>), <span class="at">graph =</span> <span class="cn">FALSE</span>,</span>
<span id="cb108-10"><a href="using-ggplot-with-other-packages.html#cb108-10" tabindex="-1"></a>                  <span class="at">name.group =</span> <span class="fu">c</span>(<span class="st">&quot;CATA&quot;</span>,<span class="st">&quot;Liking&quot;</span>)) <span class="ot">-&gt;</span> berry_mfa_res</span>
<span id="cb108-11"><a href="using-ggplot-with-other-packages.html#cb108-11" tabindex="-1"></a></span>
<span id="cb108-12"><a href="using-ggplot-with-other-packages.html#cb108-12" tabindex="-1"></a><span class="fu">save</span>(ca_cider,</span>
<span id="cb108-13"><a href="using-ggplot-with-other-packages.html#cb108-13" tabindex="-1"></a>     berry_mfa_res,</span>
<span id="cb108-14"><a href="using-ggplot-with-other-packages.html#cb108-14" tabindex="-1"></a>     <span class="at">file =</span> <span class="st">&quot;data/svd-results.RData&quot;</span>)</span></code></pre></div>
</div>
<div id="new-geom_s-and-stat_s" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> New <code>geom_*()s</code> and <code>stat_*()</code>s<a href="using-ggplot-with-other-packages.html#new-geom_s-and-stat_s" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you want to label each individual point in the plotting area using text, rather than some symbol or color that indicates the legend off to the side, you can do this using the base <code>ggplot2</code> functions <code>geom_text()</code> and <code>geom_label()</code>:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="using-ggplot-with-other-packages.html#cb109-1" tabindex="-1"></a><span class="co">#Let&#39;s use the cider CA example from before.</span></span>
<span id="cb109-2"><a href="using-ggplot-with-other-packages.html#cb109-2" tabindex="-1"></a><span class="co">#We can make our own plots from the coordinates.</span></span>
<span id="cb109-3"><a href="using-ggplot-with-other-packages.html#cb109-3" tabindex="-1"></a>ca_cider<span class="sc">$</span>col<span class="sc">$</span>coord <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="using-ggplot-with-other-packages.html#cb109-4" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;Attribute&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb109-5"><a href="using-ggplot-with-other-packages.html#cb109-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>, <span class="at">label =</span> Attribute)) <span class="sc">+</span></span>
<span id="cb109-6"><a href="using-ggplot-with-other-packages.html#cb109-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="ot">-&gt;</span> ca_cider_termplot</span>
<span id="cb109-7"><a href="using-ggplot-with-other-packages.html#cb109-7" tabindex="-1"></a></span>
<span id="cb109-8"><a href="using-ggplot-with-other-packages.html#cb109-8" tabindex="-1"></a>ca_cider_termplot <span class="sc">+</span></span>
<span id="cb109-9"><a href="using-ggplot-with-other-packages.html#cb109-9" tabindex="-1"></a>  <span class="fu">geom_text</span>()</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/using%20geom_text%20with%2022%20sensory%20attributes-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="using-ggplot-with-other-packages.html#cb110-1" tabindex="-1"></a>ca_cider_termplot <span class="sc">+</span></span>
<span id="cb110-2"><a href="using-ggplot-with-other-packages.html#cb110-2" tabindex="-1"></a>  <span class="fu">geom_label</span>()</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/using%20geom_label%20with%2022%20sensory%20attributes-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>But, as you can see, the text starts to overlap itself quickly even with only a small handful of attributes. The extension I personally use most often, to make crowded plots like this more readable, is the package <code>ggrepel</code>, which adds new <code>geom_text_repel()</code> and <code>geom_label_repel()</code>.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="using-ggplot-with-other-packages.html#cb111-1" tabindex="-1"></a>ca_cider_termplot <span class="sc">+</span></span>
<span id="cb111-2"><a href="using-ggplot-with-other-packages.html#cb111-2" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>()</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/using%20geom_label_repel%20with%2022%20sensory%20attributes-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>They’re almost identical to the normal text and label <code>geom_*()</code>s, but they use an iterative algorithm to push each piece of text away from the other text and unrelated points or <code>geom_()</code>s, while being pulled towards the point being labeled. It is <em>not deterministic</em>, so it will be slightly different each time you run the code (try it now!) unless you use <code>set.seed()</code> first or set <code>seed = ***</code> when adding <code>geom_*_repel()</code>.</p>
<p>Even with a set seed, changing the plot size or adding <code>geom_*()</code>s to the plot will also slightly change the locations of the labels, so if you’re going to try and find a seed that works well for your data, you should be checking it on your final exported plot at the publication resolution (we’ll talk about that next chapter).</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="using-ggplot-with-other-packages.html#cb112-1" tabindex="-1"></a>ca_cider_termplot <span class="sc">+</span></span>
<span id="cb112-2"><a href="using-ggplot-with-other-packages.html#cb112-2" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">seed =</span> <span class="dv">12345</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/geom_text_repel%20with%20a%20set%20seed%20will%20look%20the%20same%20every%20time-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>There are many settings you can play with to adjust these forces, how far a label has to move for a line to show up, whether any labels are left off in dense areas, and how long it tries to find a solution. And, randomly, the ability to give each letter-shape a border in a different color, which seems to be totally undocumented in the help files. It can be useful if there are other, multi-colored <code>geom_*()</code>s in the background.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="using-ggplot-with-other-packages.html#cb113-1" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="using-ggplot-with-other-packages.html#cb113-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Product =</span> <span class="fu">str_c</span>(Sample_Name, Temperature, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb113-3"><a href="using-ggplot-with-other-packages.html#cb113-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Product) <span class="sc">%&gt;%</span></span>
<span id="cb113-4"><a href="using-ggplot-with-other-packages.html#cb113-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Liking =</span> <span class="fu">mean</span>(Liking)) <span class="sc">%&gt;%</span></span>
<span id="cb113-5"><a href="using-ggplot-with-other-packages.html#cb113-5" tabindex="-1"></a>  <span class="fu">left_join</span>(ca_cider<span class="sc">$</span>row<span class="sc">$</span>coord <span class="sc">%&gt;%</span></span>
<span id="cb113-6"><a href="using-ggplot-with-other-packages.html#cb113-6" tabindex="-1"></a>              <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;Product&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb113-7"><a href="using-ggplot-with-other-packages.html#cb113-7" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">str_replace_all</span>(.x, <span class="st">&quot; &quot;</span>, <span class="st">&quot;.&quot;</span>)) <span class="ot">-&gt;</span> ca_cider_productcoord</span>
<span id="cb113-8"><a href="using-ggplot-with-other-packages.html#cb113-8" tabindex="-1"></a></span>
<span id="cb113-9"><a href="using-ggplot-with-other-packages.html#cb113-9" tabindex="-1"></a><span class="co">#This is NOT a statistically sound preference model, this is just for demonstration</span></span>
<span id="cb113-10"><a href="using-ggplot-with-other-packages.html#cb113-10" tabindex="-1"></a>ca_cider_prefmod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Liking <span class="sc">~</span> Dim<span class="fl">.1</span> <span class="sc">*</span> Dim<span class="fl">.2</span>, <span class="at">data =</span> ca_cider_productcoord)</span>
<span id="cb113-11"><a href="using-ggplot-with-other-packages.html#cb113-11" tabindex="-1"></a><span class="fu">expand.grid</span>(<span class="at">Dim.1 =</span> <span class="fu">seq</span>(<span class="fu">min</span>(ca_cider<span class="sc">$</span>col<span class="sc">$</span>coord[, <span class="st">&quot;Dim 1&quot;</span>]) <span class="sc">-</span> <span class="fl">0.1</span>,</span>
<span id="cb113-12"><a href="using-ggplot-with-other-packages.html#cb113-12" tabindex="-1"></a>                    <span class="fu">max</span>(ca_cider<span class="sc">$</span>col<span class="sc">$</span>coord[, <span class="st">&quot;Dim 1&quot;</span>]) <span class="sc">+</span> <span class="fl">0.1</span>,</span>
<span id="cb113-13"><a href="using-ggplot-with-other-packages.html#cb113-13" tabindex="-1"></a>                    <span class="at">by =</span> <span class="fl">0.01</span>),</span>
<span id="cb113-14"><a href="using-ggplot-with-other-packages.html#cb113-14" tabindex="-1"></a>            <span class="at">Dim.2 =</span> <span class="fu">seq</span>(<span class="fu">min</span>(ca_cider<span class="sc">$</span>col<span class="sc">$</span>coord[, <span class="st">&quot;Dim 2&quot;</span>]) <span class="sc">-</span> <span class="fl">0.1</span>,</span>
<span id="cb113-15"><a href="using-ggplot-with-other-packages.html#cb113-15" tabindex="-1"></a>                    <span class="fu">max</span>(ca_cider<span class="sc">$</span>col<span class="sc">$</span>coord[, <span class="st">&quot;Dim 2&quot;</span>]) <span class="sc">+</span> <span class="fl">0.1</span>,</span>
<span id="cb113-16"><a href="using-ggplot-with-other-packages.html#cb113-16" tabindex="-1"></a>                    <span class="at">by =</span> <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb113-17"><a href="using-ggplot-with-other-packages.html#cb113-17" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">Liking =</span> <span class="fu">predict</span>(ca_cider_prefmod, <span class="at">newdata =</span> .)) <span class="ot">-&gt;</span> ca_cider_prefinterp</span>
<span id="cb113-18"><a href="using-ggplot-with-other-packages.html#cb113-18" tabindex="-1"></a></span>
<span id="cb113-19"><a href="using-ggplot-with-other-packages.html#cb113-19" tabindex="-1"></a>ca_cider_termplot <span class="sc">+</span></span>
<span id="cb113-20"><a href="using-ggplot-with-other-packages.html#cb113-20" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="fu">aes</span>(<span class="at">x =</span> Dim<span class="fl">.1</span>, <span class="at">y =</span> Dim<span class="fl">.2</span>, <span class="at">z =</span> Liking, <span class="at">fill =</span> <span class="fu">after_stat</span>(level)),</span>
<span id="cb113-21"><a href="using-ggplot-with-other-packages.html#cb113-21" tabindex="-1"></a>                  <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-22"><a href="using-ggplot-with-other-packages.html#cb113-22" tabindex="-1"></a>                  <span class="at">data =</span> ca_cider_prefinterp) <span class="sc">+</span> </span>
<span id="cb113-23"><a href="using-ggplot-with-other-packages.html#cb113-23" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb113-24"><a href="using-ggplot-with-other-packages.html#cb113-24" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb113-25"><a href="using-ggplot-with-other-packages.html#cb113-25" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">6</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">bg.color =</span> <span class="st">&quot;grey7&quot;</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/geom_text_repel%20text%20borders-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Another useful tool for visualizing any ordinal/binned data (e.g., the 9-point hedonic scale) at scale is the <code>geom_beeswarm()</code> and <code>geom_quasirandom()</code> from the <code>ggbeeswarm</code> package, which are similar to <code>geom_jitter()</code> but intended for looking at a single numeric variable at a time, possibly across multiple categories.</p>
<p>They limit the jitter to a single direction and ensure that no points are overlapping (or, in the case of <code>geom_quasirandom()</code>, that there’s a uniform amount of overlap) so you can get a more accurate picture of the density, but take up less space than many faceted <code>geom_histogram()</code>s (at least for the same amount of fine-tuning).</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="using-ggplot-with-other-packages.html#cb114-1" tabindex="-1"></a><span class="co">#The jitter plot is actually not very helpful with this many points</span></span>
<span id="cb114-2"><a href="using-ggplot-with-other-packages.html#cb114-2" tabindex="-1"></a>berry_long_liking <span class="sc">%&gt;%</span></span>
<span id="cb114-3"><a href="using-ggplot-with-other-packages.html#cb114-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Scale, <span class="at">y =</span> Liking, <span class="at">color =</span> Scale)) <span class="sc">+</span></span>
<span id="cb114-4"><a href="using-ggplot-with-other-packages.html#cb114-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb114-5"><a href="using-ggplot-with-other-packages.html#cb114-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Attribute) <span class="sc">+</span></span>
<span id="cb114-6"><a href="using-ggplot-with-other-packages.html#cb114-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/using%20ggbeeswarm%20to%20compare%20ordinal%20distributions-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="using-ggplot-with-other-packages.html#cb115-1" tabindex="-1"></a><span class="co">#geom_beeswarm() will also have the same problem, but geom_quasirandom()</span></span>
<span id="cb115-2"><a href="using-ggplot-with-other-packages.html#cb115-2" tabindex="-1"></a><span class="co">#visualizes the density at each &quot;bin&quot; without us having to specify bins.</span></span>
<span id="cb115-3"><a href="using-ggplot-with-other-packages.html#cb115-3" tabindex="-1"></a><span class="co">#So these are easy to compare</span></span>
<span id="cb115-4"><a href="using-ggplot-with-other-packages.html#cb115-4" tabindex="-1"></a>berry_long_liking <span class="sc">%&gt;%</span></span>
<span id="cb115-5"><a href="using-ggplot-with-other-packages.html#cb115-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Scale, <span class="at">y =</span> Liking, <span class="at">color =</span> Scale)) <span class="sc">+</span></span>
<span id="cb115-6"><a href="using-ggplot-with-other-packages.html#cb115-6" tabindex="-1"></a>  ggbeeswarm<span class="sc">::</span><span class="fu">geom_quasirandom</span>() <span class="sc">+</span></span>
<span id="cb115-7"><a href="using-ggplot-with-other-packages.html#cb115-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Attribute) <span class="sc">+</span></span>
<span id="cb115-8"><a href="using-ggplot-with-other-packages.html#cb115-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/using%20ggbeeswarm%20to%20compare%20ordinal%20distributions-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>If you want to easily add circles and ellipses to a plot (say, the unit circle or a confidence ellipse), you’ll probably want to install the <code>ggforce</code> package and use <code>geom_circle()</code> or <code>geom_ellipse()</code>, respectively.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="using-ggplot-with-other-packages.html#cb116-1" tabindex="-1"></a>berry_mfa_res<span class="sc">$</span>quanti.var<span class="sc">$</span>coord <span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="using-ggplot-with-other-packages.html#cb116-2" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;Modality&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="using-ggplot-with-other-packages.html#cb116-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb116-4"><a href="using-ggplot-with-other-packages.html#cb116-4" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> Dim<span class="fl">.1</span>, <span class="at">yend =</span> Dim<span class="fl">.2</span>), <span class="at">arrow =</span> <span class="fu">arrow</span>()) <span class="sc">+</span></span>
<span id="cb116-5"><a href="using-ggplot-with-other-packages.html#cb116-5" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_circle</span>(<span class="fu">aes</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb116-6"><a href="using-ggplot-with-other-packages.html#cb116-6" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">x =</span> Dim<span class="fl">.1</span>, <span class="at">y =</span> Dim<span class="fl">.2</span>, <span class="at">label =</span> Modality)) <span class="sc">+</span></span>
<span id="cb116-7"><a href="using-ggplot-with-other-packages.html#cb116-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb116-8"><a href="using-ggplot-with-other-packages.html#cb116-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/adding%20a%20unit%20circle%20with%20ggforce-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="new-theme_s-and-scale_s" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> New <code>theme_*()</code>s and <code>scale_*()</code>s<a href="using-ggplot-with-other-packages.html#new-theme_s-and-scale_s" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Most of the additional <code>geom_*()</code>s in <code>ggplot2</code> extensions involve some sort of calculation, so the confidence that you’re using someone else’s algorithm that’s (hopefully!) been double-checked is a real benefit. You’ve already seen how to change the way your plots look with <code>theme()</code> one argument at a time, and how to set <code>scale_*_manual()</code> if you have the exact colors or color range that you want.</p>
<p>So there’s nothing these prettying-up packages will do that you can’t do yourself, but there are a huge number of <code>ggplot2</code> extensions that include some version of a no-gridline minimal theme for convenience. Such as:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="using-ggplot-with-other-packages.html#cb117-1" tabindex="-1"></a>berry_long_liking <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="using-ggplot-with-other-packages.html#cb117-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Scale, <span class="at">y =</span> Liking, <span class="at">color =</span> Scale)) <span class="sc">+</span></span>
<span id="cb117-3"><a href="using-ggplot-with-other-packages.html#cb117-3" tabindex="-1"></a>  ggbeeswarm<span class="sc">::</span><span class="fu">geom_quasirandom</span>() <span class="sc">+</span></span>
<span id="cb117-4"><a href="using-ggplot-with-other-packages.html#cb117-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Attribute) <span class="sc">+</span></span>
<span id="cb117-5"><a href="using-ggplot-with-other-packages.html#cb117-5" tabindex="-1"></a>  cowplot<span class="sc">::</span><span class="fu">theme_minimal_hgrid</span>()</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/the%20minimal%20themes%20in%20cowplot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Packages that added <code>scale_*()</code>s used to be one of the most common kinds of ggplot extensions (because, as you’ll notice, the above figure with the default color scale is not red-green colorblind friendly), but the most popular scales now come with <code>ggplot2</code> itself.</p>
<p><code>RColorBrewer</code>’s colorblind- and printer-friendly palettes for categorical data are now available in <code>ggplot2::scale_*_brewer_*()</code>, and you’ve already seen us use the <code>viridis</code> color palettes in <code>ggplot2::scale_*_viridis_*()</code>. The <code>viridis</code> color scales <em>can</em> be used for categorical data, if you use the <code>_d()</code> versions, but they were designed for ordinal and binned data, since some colors will seem more related than others. See <a href="https://clauswilke.com/dataviz/color-basics.html">Chapter 4</a> and <a href="https://clauswilke.com/dataviz/color-pitfalls.html">Chapter 19</a> of Claus O. Wilke’s book <em>Fundamentals of Data Visualization</em>.</p>
</div>
<div id="modifying-ggplots-made-by-other-packages" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Modifying <code>ggplot()</code>s made by other packages<a href="using-ggplot-with-other-packages.html#modifying-ggplots-made-by-other-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far in this chapter, we’ve been making all of the plots with a call to <code>ggplot()</code> and then adding on geoms, themes, labels, scales, and facets with <code>+</code>. But we’ve also been able to save our plots to variables partway through and then keep adding things to the saved plots. This is an incredibly useful difference from the way plots work in base R.</p>
<p>Some packages utilize <code>ggplot2</code> by making a whole plot for you with their own internal call to <code>ggplot()</code>, which means that you can treat it like any other ggplot for the sake of customizing. Most packages which can save a whole plot to a variable or output several plots in a list use <code>ggplot()</code> to do so.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="using-ggplot-with-other-packages.html#cb118-1" tabindex="-1"></a><span class="co">#FactoMineR uses ggplot for its internal plotting,</span></span>
<span id="cb118-2"><a href="using-ggplot-with-other-packages.html#cb118-2" tabindex="-1"></a><span class="co">#Which is why we can assign the output to a variable</span></span>
<span id="cb118-3"><a href="using-ggplot-with-other-packages.html#cb118-3" tabindex="-1"></a><span class="co">#and not see the plot right away</span></span>
<span id="cb118-4"><a href="using-ggplot-with-other-packages.html#cb118-4" tabindex="-1"></a><span class="co">#(although the CA() function will also display several plots by default)</span></span>
<span id="cb118-5"><a href="using-ggplot-with-other-packages.html#cb118-5" tabindex="-1"></a>cider_contingency <span class="sc">%&gt;%</span></span>
<span id="cb118-6"><a href="using-ggplot-with-other-packages.html#cb118-6" tabindex="-1"></a>  FactoMineR<span class="sc">::</span><span class="fu">CA</span>(<span class="at">graph =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-7"><a href="using-ggplot-with-other-packages.html#cb118-7" tabindex="-1"></a>  FactoMineR<span class="sc">::</span><span class="fu">plot.CA</span>() <span class="ot">-&gt;</span> ca_cider_biplot_facto</span>
<span id="cb118-8"><a href="using-ggplot-with-other-packages.html#cb118-8" tabindex="-1"></a></span>
<span id="cb118-9"><a href="using-ggplot-with-other-packages.html#cb118-9" tabindex="-1"></a><span class="co">#The ca package, meanwhile, uses base plotting.</span></span>
<span id="cb118-10"><a href="using-ggplot-with-other-packages.html#cb118-10" tabindex="-1"></a><span class="co">#You can tell because it prints this plot immediately.</span></span>
<span id="cb118-11"><a href="using-ggplot-with-other-packages.html#cb118-11" tabindex="-1"></a>cider_contingency <span class="sc">%&gt;%</span></span>
<span id="cb118-12"><a href="using-ggplot-with-other-packages.html#cb118-12" tabindex="-1"></a>  ca<span class="sc">::</span><span class="fu">ca</span>() <span class="sc">%&gt;%</span></span>
<span id="cb118-13"><a href="using-ggplot-with-other-packages.html#cb118-13" tabindex="-1"></a>  ca<span class="sc">::</span><span class="fu">plot.ca</span>() <span class="ot">-&gt;</span> ca_cider_biplot_green</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/FactoMineR%20makes%20ggplots-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can see that the last code chunk only output one plot right away, but we can confirm our suspicions with the base <code>R</code> <code>class()</code> function.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="using-ggplot-with-other-packages.html#cb119-1" tabindex="-1"></a><span class="fu">class</span>(ca_cider_termplot) <span class="co"># Made with ggplot() ourselves</span></span></code></pre></div>
<pre><code>## [1] &quot;gg&quot;     &quot;ggplot&quot;</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="using-ggplot-with-other-packages.html#cb121-1" tabindex="-1"></a><span class="fu">class</span>(ca_cider_biplot_facto) <span class="co"># Made with ggplot-based FactoMineR</span></span></code></pre></div>
<pre><code>## [1] &quot;gg&quot;     &quot;ggplot&quot;</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="using-ggplot-with-other-packages.html#cb123-1" tabindex="-1"></a><span class="fu">class</span>(ca_cider_biplot_green) <span class="co"># Made with ca::ca(), not a plot at all</span></span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="using-ggplot-with-other-packages.html#cb125-1" tabindex="-1"></a>ca_cider_biplot_green <span class="co"># It&#39;s two tables of coordinates!</span></span></code></pre></div>
<pre><code>## $rows
##                          Dim1        Dim2
## 1911 Est. Chilled -0.30922746  0.02323046
## 1911 Est. RT      -0.33096663  0.04492088
## Buskey Chilled     0.01508206 -0.16463573
## Buskey RT          0.19222871 -0.19341072
## Eden Chilled       0.22460300  0.13702229
## Eden RT            0.20122093  0.14661009
## 
## $cols
##                     Dim1        Dim2
## Fresh_Apples -0.30305451  0.08260444
## Fermented     0.05136995 -0.11123214
## Herbal        0.27953814  0.05798442
## Dry           0.09068713 -0.09458987
## Spice         0.09194648 -0.15607561
## Fruity       -0.26360780  0.04401256
## Smooth       -0.23141023 -0.16865980
## Alcohol       0.08456228 -0.05135981
## Light        -0.13444990 -0.13768159
## Sweet        -0.13152453 -0.06963735
## Woody         0.32164765  0.18574435
## Berries      -0.38694032  0.08324652
## Sour         -0.03153644  0.19917586
## Funky         0.56153039 -0.01014260
## FullBodied   -0.01727177 -0.10673686
## Metallic      0.13770506  0.36391448
## Floral        0.05665116 -0.01517803
## Candy        -0.73752932  0.35245085
## Bitter        0.17535866 -0.02812715
## Vomit         0.43823154  0.03719609
## Earthy        0.43043925 -0.06405187
## Synthetic     0.35094003  0.33924051</code></pre>
<p>What this means is that we can look at the <code>FactoMineR</code>-made plot we’ve saved to <code>ca_cider_biplot_facto</code>:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="using-ggplot-with-other-packages.html#cb127-1" tabindex="-1"></a>ca_cider_biplot_facto</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/you%20can%20see%20saved%20ggplots%20by%20calling%20the%20variable-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><em>And</em> we can still change up many of the elements by adding additional elements, although you’re likely to get some weird warning messages <em>and</em> some silent errors. (The <code>ggrepel</code> error message is actually just because there are too many <code>geom_text_repel()</code> labels close-together in a small plots, because expanding <code>xlim()</code> crowds everything in the center of the plot.)</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="using-ggplot-with-other-packages.html#cb128-1" tabindex="-1"></a>ca_cider_biplot_facto <span class="sc">+</span></span>
<span id="cb128-2"><a href="using-ggplot-with-other-packages.html#cb128-2" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(), <span class="co"># Removes the axis lines</span></span>
<span id="cb128-3"><a href="using-ggplot-with-other-packages.html#cb128-3" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="co"># Removes the title</span></span>
<span id="cb128-4"><a href="using-ggplot-with-other-packages.html#cb128-4" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="co"># Extends the x limits, with a warning</span></span>
<span id="cb128-5"><a href="using-ggplot-with-other-packages.html#cb128-5" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>)</span></code></pre></div>
<pre><code>## Scale for x is already present.
## Adding another scale for x, which will replace the existing scale.</code></pre>
<p><img src="04-ggplot2-extensions_files/figure-html/you%20can%20change%20many%20things%20about%20FactoMineR%20plots%20with%20ggplot%20semantics-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="using-ggplot-with-other-packages.html#cb130-1" tabindex="-1"></a>  <span class="co"># Silently fails to change the color scale</span></span></code></pre></div>
<p>You can’t just <code>+ scale_color_*()</code> to a <code>FactoMineR</code> plot, because the <code>ggplot</code> already has a non-default color scheme and adding a second color scale does nothing. If you look at the help file for <code>?FactoMineR::plot.CA</code>, you can set several styling parameters when you’re making the plot, and you can remake it as many times as you need, but doing so does have significantly less flexibility than the approach to plotting we’ve outlined in this workshop.</p>
<p>We also can’t go back and adjust the parameters passed to <code>geom_text_repel()</code> after the fact, even though we can tell from the warning messages that that’s the package being used to put the attribute and product names onto the biplot.</p>
<p>It will almost always be possible to add more <code>geom_*()</code>s to plots made by other packages, as long as you don’t mind them being added <em>on top of</em> any existing elements in the plot.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="using-ggplot-with-other-packages.html#cb131-1" tabindex="-1"></a>liking_arrow <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="dv">0</span>, <span class="at">y1 =</span> <span class="dv">0</span>, <span class="at">x2 =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="at">y2 =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">text =</span> <span class="st">&quot;Liking&quot;</span>)</span>
<span id="cb131-2"><a href="using-ggplot-with-other-packages.html#cb131-2" tabindex="-1"></a></span>
<span id="cb131-3"><a href="using-ggplot-with-other-packages.html#cb131-3" tabindex="-1"></a>ca_cider_biplot_facto <span class="sc">+</span></span>
<span id="cb131-4"><a href="using-ggplot-with-other-packages.html#cb131-4" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span> x1, <span class="at">y =</span> y1, <span class="at">xend =</span> x2, <span class="at">yend =</span> y2), <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb131-5"><a href="using-ggplot-with-other-packages.html#cb131-5" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">&quot;npc&quot;</span>)), <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb131-6"><a href="using-ggplot-with-other-packages.html#cb131-6" tabindex="-1"></a>               <span class="at">data =</span> liking_arrow) <span class="sc">+</span></span>
<span id="cb131-7"><a href="using-ggplot-with-other-packages.html#cb131-7" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> x2, <span class="at">y =</span> y2, <span class="at">label =</span> text), <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb131-8"><a href="using-ggplot-with-other-packages.html#cb131-8" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="st">&quot;outward&quot;</span>, <span class="at">vjust =</span> <span class="st">&quot;outward&quot;</span>, <span class="at">fontface =</span> <span class="st">&quot;italic&quot;</span>,</span>
<span id="cb131-9"><a href="using-ggplot-with-other-packages.html#cb131-9" tabindex="-1"></a>            <span class="at">data =</span> liking_arrow)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/you%20can%20easily%20add%20new%20geoms%20to%20FactoMineR%20plots-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If you desperately need to <a href="https://cran.r-project.org/web/packages/gginnards/vignettes/user-guide-2.html#replacing-scales-coordinates-whole-themes-and-data.">change a scale or reorder <code>geom_*()</code>s from an existing <code>ggplot</code></a> in a hurry, look into the <code>gginnards</code> package.</p>
</div>
<div id="combining-plots" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Combining Plots<a href="using-ggplot-with-other-packages.html#combining-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You’ve already seen how to <code>facet_*()</code> plots to view “small multiple” plots side-by side:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="using-ggplot-with-other-packages.html#cb132-1" tabindex="-1"></a>raw_cider_data <span class="sc">%&gt;%</span></span>
<span id="cb132-2"><a href="using-ggplot-with-other-packages.html#cb132-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Fresh_Apples<span class="sc">:</span>Synthetic) <span class="sc">%&gt;%</span></span>
<span id="cb132-3"><a href="using-ggplot-with-other-packages.html#cb132-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Sample_Name, Temperature, name) <span class="sc">%&gt;%</span></span>
<span id="cb132-4"><a href="using-ggplot-with-other-packages.html#cb132-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">sum</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb132-5"><a href="using-ggplot-with-other-packages.html#cb132-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">interaction</span>(Sample_Name, Temperature), <span class="at">y =</span> total)) <span class="sc">+</span> </span>
<span id="cb132-6"><a href="using-ggplot-with-other-packages.html#cb132-6" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Sample_Name)) <span class="sc">+</span></span>
<span id="cb132-7"><a href="using-ggplot-with-other-packages.html#cb132-7" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> wesanderson<span class="sc">::</span>wes_palettes<span class="sc">$</span>FantasticFox1) <span class="sc">+</span> </span>
<span id="cb132-8"><a href="using-ggplot-with-other-packages.html#cb132-8" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb132-9"><a href="using-ggplot-with-other-packages.html#cb132-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb132-10"><a href="using-ggplot-with-other-packages.html#cb132-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb132-11"><a href="using-ggplot-with-other-packages.html#cb132-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb132-12"><a href="using-ggplot-with-other-packages.html#cb132-12" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> cider_count_plot</span>
<span id="cb132-13"><a href="using-ggplot-with-other-packages.html#cb132-13" tabindex="-1"></a></span>
<span id="cb132-14"><a href="using-ggplot-with-other-packages.html#cb132-14" tabindex="-1"></a>cider_count_plot <span class="sc">+</span></span>
<span id="cb132-15"><a href="using-ggplot-with-other-packages.html#cb132-15" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">ncol =</span> <span class="dv">6</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/remember%20faceting-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This works very well whenever you have multiple plots using the same <code>geom_*()</code>s that you want to show on the same axes, and you can even adjust the axis limits from facet to facet using <code>scales = "free*"</code>:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="using-ggplot-with-other-packages.html#cb133-1" tabindex="-1"></a>cider_count_plot <span class="sc">+</span></span>
<span id="cb133-2"><a href="using-ggplot-with-other-packages.html#cb133-2" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">ncol =</span> <span class="dv">6</span>,</span>
<span id="cb133-3"><a href="using-ggplot-with-other-packages.html#cb133-3" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="co"># Each plot now has a different x-axis</span></span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/faceted%20plots%20with%20different%20x-axes-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Not that we’d argue you <em>should</em> here. Also, take note that the <code>x</code> in <code>free_x</code> refers to the horizontal axis in the final plot, <em>after</em> the <code>coord_flip()</code>, and <em>not</em> the <code>x</code> aesthetic we set in the <code>ggplot()</code> call.</p>
<p>But if you have different plot types entirely (different data sources, different <code>geom_()</code>s, or different categorical axes) that you want to place side-by-side, say a loading plot and the product map resulting from a PCA or MFA, you’re going to need something to paste together multiple <code>ggplot_()</code>s.</p>
<p>The easiest way to do this is using <code>patchwork</code>, which will work on ggplots you’ve made yourself <em>or</em> with ones made by packages like <code>FactoMineR</code>. <em>When you have <code>patchwork</code> loaded</em>, the <code>+</code> operator will put two plots side-by-side:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="using-ggplot-with-other-packages.html#cb134-1" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb134-2"><a href="using-ggplot-with-other-packages.html#cb134-2" tabindex="-1"></a><span class="fu">plot</span>(berry_mfa_res, <span class="at">choix =</span> <span class="st">&quot;var&quot;</span>) <span class="sc">+</span> <span class="fu">plot</span>(berry_mfa_res, <span class="at">partial =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/combining%20plots%20with%20patchwork-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>And the <code>/</code> operator will arrange two plots vertically:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="using-ggplot-with-other-packages.html#cb135-1" tabindex="-1"></a><span class="fu">plot</span>(berry_mfa_res, <span class="at">choix =</span> <span class="st">&quot;var&quot;</span>) <span class="sc">/</span> <span class="fu">plot</span>(berry_mfa_res, <span class="at">partial =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/arranging%20plots%20vertically%20with%20patchwork-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The advantage of doing this with a package like <code>patchwork</code>, rather than saving separate images, is that it aligns all of the plot areas precisely and that they will more easily move or rearrange certain plot elements like legends and axis labels.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="using-ggplot-with-other-packages.html#cb136-1" tabindex="-1"></a><span class="fu">plot</span>(berry_mfa_res, <span class="at">choix =</span> <span class="st">&quot;var&quot;</span>) <span class="sc">+</span> <span class="fu">plot</span>(berry_mfa_res, <span class="at">partial =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-2"><a href="using-ggplot-with-other-packages.html#cb136-2" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb136-3"><a href="using-ggplot-with-other-packages.html#cb136-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb136-4"><a href="using-ggplot-with-other-packages.html#cb136-4" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/collecting%20legends%20at%20the%20bottom%20of%20a%20patchwork%20ensemble-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The <code>&amp;</code> operator lets you add elements like themes or annotations to all of the plots you’ve combined together. <code>plot_layout()</code> is a <code>patchwork</code> function that lets you set relative plot sizes, decide how to arrange more than 2 plots, and move legends:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="using-ggplot-with-other-packages.html#cb137-1" tabindex="-1"></a><span class="fu">plot</span>(berry_mfa_res, <span class="at">partial =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">+</span></span>
<span id="cb137-2"><a href="using-ggplot-with-other-packages.html#cb137-2" tabindex="-1"></a>  (<span class="fu">plot</span>(berry_mfa_res, <span class="at">choix =</span> <span class="st">&quot;var&quot;</span>) <span class="sc">+</span></span>
<span id="cb137-3"><a href="using-ggplot-with-other-packages.html#cb137-3" tabindex="-1"></a>  <span class="fu">plot</span>(berry_mfa_res, <span class="at">choix =</span> <span class="st">&quot;freq&quot;</span>, <span class="at">invisible =</span> <span class="st">&quot;ind&quot;</span>)) <span class="sc">+</span></span>
<span id="cb137-4"><a href="using-ggplot-with-other-packages.html#cb137-4" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">widths =</span> <span class="dv">2</span>) <span class="sc">&amp;</span></span>
<span id="cb137-5"><a href="using-ggplot-with-other-packages.html#cb137-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb137-6"><a href="using-ggplot-with-other-packages.html#cb137-6" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb137-7"><a href="using-ggplot-with-other-packages.html#cb137-7" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/more%20complex%20patchwork%20layout-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If you want to put images anywhere on a visualization, you’re struggling to make a complex arrangement with <code>patchwork</code>, or you have an <code>R</code> <code>list</code> structure containing multiple plots (say, the result of a <code>for</code> loop, <code>*apply()</code>, or <code>nest()</code> call), then <code>cowplot</code> is another option:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="using-ggplot-with-other-packages.html#cb138-1" tabindex="-1"></a>berry_mfa_res<span class="sc">$</span>separate.analyses <span class="sc">%&gt;%</span></span>
<span id="cb138-2"><a href="using-ggplot-with-other-packages.html#cb138-2" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="cf">function</span>(x) {</span>
<span id="cb138-3"><a href="using-ggplot-with-other-packages.html#cb138-3" tabindex="-1"></a>    x<span class="sc">$</span>ind<span class="sc">$</span>coord <span class="sc">%&gt;%</span></span>
<span id="cb138-4"><a href="using-ggplot-with-other-packages.html#cb138-4" tabindex="-1"></a>      <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;Berry&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-5"><a href="using-ggplot-with-other-packages.html#cb138-5" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Dim<span class="fl">.1</span>, <span class="at">y =</span> Dim<span class="fl">.2</span>)) <span class="sc">+</span></span>
<span id="cb138-6"><a href="using-ggplot-with-other-packages.html#cb138-6" tabindex="-1"></a>      <span class="fu">geom_point</span>()</span>
<span id="cb138-7"><a href="using-ggplot-with-other-packages.html#cb138-7" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span></span>
<span id="cb138-8"><a href="using-ggplot-with-other-packages.html#cb138-8" tabindex="-1"></a>  cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ., <span class="at">labels =</span> <span class="fu">names</span>(.))</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/plotting%20a%20list-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="using-ggplot-with-other-packages.html#cb139-1" tabindex="-1"></a><span class="co">#You can also pipe your list into patchwork::wrap_plots()</span></span>
<span id="cb139-2"><a href="using-ggplot-with-other-packages.html#cb139-2" tabindex="-1"></a><span class="co">#if you have the latest version of patchwork.</span></span>
<span id="cb139-3"><a href="using-ggplot-with-other-packages.html#cb139-3" tabindex="-1"></a><span class="co">#It&#39;s a fairly new package, so it gains big new features very often.</span></span></code></pre></div>
<p>Both of these packages can also add letters and other labels to each plot:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="using-ggplot-with-other-packages.html#cb140-1" tabindex="-1"></a><span class="fu">plot</span>(berry_mfa_res, <span class="at">choix =</span> <span class="st">&quot;var&quot;</span>) <span class="sc">+</span> <span class="fu">plot</span>(berry_mfa_res, <span class="at">partial =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">+</span></span>
<span id="cb140-2"><a href="using-ggplot-with-other-packages.html#cb140-2" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">+</span></span>
<span id="cb140-3"><a href="using-ggplot-with-other-packages.html#cb140-3" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>) <span class="sc">&amp;</span></span>
<span id="cb140-4"><a href="using-ggplot-with-other-packages.html#cb140-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb140-5"><a href="using-ggplot-with-other-packages.html#cb140-5" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/labeling%20plots-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="using-ggplot-with-other-packages.html#cb141-1" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="fu">plot</span>(berry_mfa_res, <span class="at">choix =</span> <span class="st">&quot;var&quot;</span>),</span>
<span id="cb141-2"><a href="using-ggplot-with-other-packages.html#cb141-2" tabindex="-1"></a>                   <span class="fu">plot</span>(berry_mfa_res, <span class="at">partial =</span> <span class="st">&quot;all&quot;</span>),</span>
<span id="cb141-3"><a href="using-ggplot-with-other-packages.html#cb141-3" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="st">&quot;AUTO&quot;</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/labeling%20plots-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="using-ggplot-with-other-packages.html#cb142-1" tabindex="-1"></a><span class="co">#Cowplot doesn&#39;t have a way to combine or move legends.</span></span>
<span id="cb142-2"><a href="using-ggplot-with-other-packages.html#cb142-2" tabindex="-1"></a><span class="co">#You&#39;d have to move the legends *before* using plot_grid()</span></span></code></pre></div>
<p>If you need to move or realign the labels so they’re not overlapping anything, in <code>patchwork</code> you can add <code>theme(plot.tag.position = c(X, Y))</code> to individual plots with <code>+</code> or to the whole grouping of plots with <code>&amp;</code>. The <code>cowplot::plot_grid()</code> function has arguments <code>labels_x</code> and <code>labels_y</code>, which let you adjust the distance from the bottom left hand corner of the figure.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="using-ggplot-with-other-packages.html#cb143-1" tabindex="-1"></a><span class="fu">plot</span>(berry_mfa_res, <span class="at">choix =</span> <span class="st">&quot;var&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.tag.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.95</span>)) <span class="sc">+</span></span>
<span id="cb143-2"><a href="using-ggplot-with-other-packages.html#cb143-2" tabindex="-1"></a>  <span class="fu">plot</span>(berry_mfa_res, <span class="at">partial =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.tag.position =</span> <span class="fu">c</span>(<span class="fl">0.12</span>, <span class="fl">0.95</span>)) <span class="sc">+</span></span>
<span id="cb143-3"><a href="using-ggplot-with-other-packages.html#cb143-3" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-4"><a href="using-ggplot-with-other-packages.html#cb143-4" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>) <span class="sc">&amp;</span></span>
<span id="cb143-5"><a href="using-ggplot-with-other-packages.html#cb143-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb143-6"><a href="using-ggplot-with-other-packages.html#cb143-6" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/moving%20plot%20labels-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="using-ggplot-with-other-packages.html#cb144-1" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="fu">plot</span>(berry_mfa_res, <span class="at">choix =</span> <span class="st">&quot;var&quot;</span>),</span>
<span id="cb144-2"><a href="using-ggplot-with-other-packages.html#cb144-2" tabindex="-1"></a>                   <span class="fu">plot</span>(berry_mfa_res, <span class="at">partial =</span> <span class="st">&quot;all&quot;</span>),</span>
<span id="cb144-3"><a href="using-ggplot-with-other-packages.html#cb144-3" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="st">&quot;AUTO&quot;</span>,</span>
<span id="cb144-4"><a href="using-ggplot-with-other-packages.html#cb144-4" tabindex="-1"></a>                   <span class="at">label_y =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="04-ggplot2-extensions_files/figure-html/moving%20plot%20labels-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can also use any image editing, publishing, or graphics software to manually combine, arrange, and label plots, but if you need to make changes to a plot later then doing your layout <em>in <code>R</code></em> will mean you just have to run the lightly-updated code again to re-export a fully formatted multi-part figure, even if the plot dimensions change.</p>
</div>
<div id="finding-new-packages" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Finding New Packages<a href="using-ggplot-with-other-packages.html#finding-new-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This isn’t all the functionality of any of these packages, and these aren’t the only packages that add new features to <code>ggplot2</code>.</p>
<p>If you’re trying to figure out how to create a type of plot you’ve never made before, we’d recommend:</p>
<ol style="list-style-type: decimal">
<li>Ask yourself what variables are represented by the x and y axes, the shapes, the line types, or the colors. Think about whether you can build the plot from smaller components. Is it a grid of scatterplots with colored contour regions? How much of the plot is just points, lines, or rectangles with fancy formatting? You can do <strong>a lot</strong> with just <code>ggplot2</code>!</li>
<li>See if any of the packages in <a href="https://exts.ggplot2.tidyverse.org/gallery/">the list of registered ggplot extensions</a> have a plot similar to yours. These packages tend to have very thorough and visual documentation.</li>
<li>If it’s a sensory-specific plot, <a href="https://jlahne.github.io/r-opus-v2/index.html">check out the <code>R</code> Opus v2</a>. Almost all of the plots only use <code>ggplot2</code>, <code>patchwork</code>, and <code>ggrepel</code>.</li>
<li>Use a web search with the kind of plot you want to make and the keyword “ggplot2” to find tutorials or discussions with example code. Results from <a href="https://stackoverflow.com/questions/tagged/ggplot2">Stack Overflow</a>, <a href="https://www.data-to-viz.com/">Data to Viz</a>, or <a href="https://r-graph-gallery.com/index.html"><code>R</code> Graph Gallery</a> are all likely to have good explanations and useful examples, while anything with “(# examples)” in the article name is likely to be very basic material with good SEO.</li>
</ol>
<p>Keep in mind that keywords primarily used in sensory science, say “preference map” or “penalty analysis”, are unlikely to yield examples in <code>ggplot2</code> with extensive results. In my own process of troubleshooting and double-checking for this workshop, I’ve found some helpful examples by searching “add density contours to 2d scatterplot ggplot” or “ordered bar plot positive and negative ggplot”.</p>
<p>Package documentation might come up while you’re looking, but the examples are often very abstract and simple, and they’re often structured around names of functions rather than concepts, so it’s often faster to see some examples of real plots that other people (who aren’t writing an entire <code>R</code> package) wanted to make and then looking up the functions they used to do so.</p>
<p>Now, with the rest of the time we have left, I’m going to try and show off how I do some of the most common cleaning-up when it’s time to actually present or publish.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-basics-of-plotting-with-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fine-tuning-publication-quality-ggplots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
